webpackJsonp([1],{0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var a=n(689),o=n(796),i=r(o),l=n(847),s=r(l),u=n(755),c=n(756),f=s["default"].getProps("#map-editor");c.render(u.createElement(a.DrawerHeader,f),document.getElementById("header")),c.render(u.createElement(i["default"],f),document.getElementById("drawer"))},689:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MainMenu=t.MainSiderBar=t.DrawerHeader=t.HomeHeader=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(690),u=r(s),c=n(753),f=r(c),p=n(757),d=r(p),h=n(1),m=n(153),y=(t.HomeHeader=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){return h.createElement("header",{className:"main-header"},h.createElement("a",{href:"/",className:"logo"},"Karte"),h.createElement("nav",{className:"navbar navbar-static-top",role:"navigation"},h.createElement("div",{className:"navbar-custom-menu"},h.createElement("ul",{className:"nav navbar-nav"},h.createElement("li",null,h.createElement("a",{href:"#",className:"dropdown-toggle","data-toggle":"dropdown"},"admin")),h.createElement("li",null,h.createElement("a",{href:"/karte/logout"},"退出")))),h.createElement(y,{ref:"menu"})))}}]),t}(h.Component),t.DrawerHeader=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={title:""},i=n,o(r,i)}return i(t,e),l(t,[{key:"openMenu",value:function(){$(m.findDOMNode(this.refs.menu)).css("left","0px")}},{key:"render",value:function(){return h.createElement("header",{className:"main-header"},h.createElement("a",{href:"/",className:"logo"},"Karte"),h.createElement("nav",{className:"navbar navbar-static-top",role:"navigation"},h.createElement("a",{href:"#",className:"sidebar-toggle",onClick:this.openMenu.bind(this)},h.createElement("span",{className:"sr-only"},"Toggle navigation")),h.createElement("div",{className:"navbar-collapse pull-left collapse"},h.createElement("ul",{className:"nav navbar-nav"},h.createElement("li",null,h.createElement("span",null,(this.state.title||this.props.title)+this.props.extname)))),h.createElement("div",{className:"navbar-custom-menu"},h.createElement("ul",{className:"nav navbar-nav"},h.createElement("li",null,h.createElement("a",{href:"#",className:"dropdown-toggle","data-toggle":"dropdown"},"admin")),h.createElement("li",null,h.createElement("a",{href:"/karte/logout"},"退出")))),h.createElement(y,{ref:"menu",fileId:this.props.id,fileTitle:this.props.title,header:this})))}}]),t}(h.Component),t.MainSiderBar=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){return h.createElement("div",{className:"main-sidebar"},h.createElement("div",{className:"sidebar"},h.createElement("ul",{className:"sidebar-menu"},h.createElement("li",{className:"active"},h.createElement("a",{href:"/home"},h.createElement("i",{className:"glyphicon glyphicon-home"}),h.createElement("span",null,"我的文件"))))))}}]),t}(h.Component),t.MainMenu=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={recent_files:[],current_file:null},i=n,o(r,i)}return i(t,e),l(t,[{key:"close",value:function(){$(m.findDOMNode(this)).css("left","-740px")}},{key:"handleUploadFile",value:function(){this.refs.fileUploader.open(),this.close()}},{key:"handleRenameFile",value:function(){this.refs.fileRenamer.open(),this.close()}},{key:"handleExportFile",value:function(){this.refs.fileExporter.open(),this.close()}},{key:"componentDidMount",value:function(){this.getRecentFile()}},{key:"getRecentFile",value:function(){var e=this;$.get("/karte/recent_files",function(t){"ok"==t.msg&&e.setState({recent_files:t.maps})})}},{key:"openFile",value:function(e){window.location="/file/"+e}},{key:"renderRecentFileList",value:function(){var e=this,t=this.state.recent_files.map(function(t,n){var r=(new Date).getTime(),a=new Date(t.modify_time).getTime(),o=(r-a)/864e5|0;return h.createElement("li",{className:"ng-scope",onClick:e.openFile.bind(e,t._id.$oid),key:n},h.createElement("span",{className:"icon"},h.createElement("i",{className:"fa fa-file-image-o"})),h.createElement("span",{className:"filename"},t.title+t.extname),h.createElement("span",{className:"info"},o," 天前"))});return t}},{key:"render",value:function(){return h.createElement("div",{className:"main-menu",tabIndex:"-1"},h.createElement("ul",{className:"tab-head"},h.createElement("li",{className:"close-menu",onClick:this.close.bind(this)},h.createElement("i",{className:"fa fa-chevron-left"})),h.createElement("li",{className:"main-menu-tool active"}," ",h.createElement("a",{href:"#tool-new","data-toggle":"tab"},h.createElement("span",null,"新建"))),h.createElement("li",{className:"main-menu-tool"}," ",h.createElement("a",{href:"#tool-open","data-toggle":"tab"},h.createElement("span",null,"打开"))),h.createElement("li",{className:"main-menu-tool"}," ",h.createElement("a",{href:"#tool-export","data-toggle":"tab"},h.createElement("span",null,"导出")))),h.createElement("div",{className:"tab-body tab-content"},h.createElement("div",{className:"tab-pane active",id:"tool-new"},h.createElement("h2",{className:"title"},"新建"),h.createElement("ul",{className:"template-list"},h.createElement("a",{href:"/karte/new_map"},h.createElement("li",{className:"template-item"},h.createElement("span",null,"空白地图"))))),h.createElement("div",{className:"tab-pane",id:"tool-open"},h.createElement("h2",{className:"title"},"打开"),h.createElement("h3",{className:"latest-files-title"},"最近使用的文件"),h.createElement("ul",{className:"latest-files"},this.renderRecentFileList()),h.createElement("a",{className:"go-home",href:"/home",target:"_self",title:"到我的文档里查看更多"},"到我的文档里查看更多.."),h.createElement("div",{className:"item import-file",onClick:this.handleUploadFile.bind(this)},h.createElement("i",{className:"glyphicon glyphicon-open icon"}),h.createElement("span",{className:"item-name"},"打开本地文件"),h.createElement("span",{className:"item-info"},"上传本地地图文件，并编辑"))),h.createElement("div",{className:"tab-pane",id:"tool-export"},h.createElement("h2",{className:"title"},"导出"),h.createElement("ul",{className:"items"},h.createElement("li",{className:"item",onClick:this.handleRenameFile.bind(this)},h.createElement("i",{className:"glyphicon glyphicon-edit icon"}),h.createElement("span",{className:"item-name"},"重命名"),h.createElement("span",{className:"item-info"},"重命名此文件")),h.createElement("li",{className:"item",onClick:this.handleExportFile.bind(this)},h.createElement("i",{className:"glyphicon glyphicon-save icon"}),h.createElement("span",{className:"item-name"},"导出"),h.createElement("span",{className:"item-info"},"将文件导出到本地（不包含第三方格式，.dxf 文件除外）"))))),h.createElement(u["default"],{ref:"fileUploader"}),h.createElement(f["default"],{ref:"fileRenamer",fileId:this.props.fileId,fileTitle:this.props.fileTitle,header:this.props.header}),h.createElement(d["default"],{ref:"fileExporter",fileId:this.props.fileId,fileTitle:this.props.fileTitle}))}}]),t}(h.Component))},690:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(691),s=r(l),u=n(736),c=r(u),f=n(732),p=r(f),d=n(737),h=r(d),m=n(741),y=r(m),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=n(1),E=(n(153),y["default"].Dragger),w=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={showModal:!1,fileList:[]},r.uploadProps={name:"file",showUploadList:!0,action:"/karte/upload",accept:".dxf,.json,.kml"},i=n,o(r,i)}return i(t,e),b(t,[{key:"open",value:function(){this.setState({showModal:!0})}},{key:"close",value:function(){this.setState({showModal:!1})}},{key:"onUploadChange",value:function(e){var t=e.file,n=e.fileList;n=n.slice(-1),"done"==t.status&&(t.response.map?this.load(t.response.map):(this.setState({data:null}),h["default"].info("上传的文件格式错误!!",3),n=n.filter(function(e){return!e.response||"failed"!==e.response.msg}))),this.setState({fileList:n})}},{key:"load",value:function(e){if(e){var t=e._id.$oid;return this.close(),window.location="/file/"+t,!0}return h["default"].info("还未上传地图文件!",3),!1}},{key:"render",value:function(){return g.createElement(s["default"],{title:"打开文件",visible:this.state.showModal,onCancel:this.close.bind(this),footer:g.createElement(p["default"],{type:"primary",onClick:this.close.bind(this)},"确定")},g.createElement("form",{id:"mapUploader",action:"/karte/upload",method:"post",encType:"multipart/form-data"},g.createElement("div",{className:"modal-body"},g.createElement("div",{className:"form-group",style:{height:160}},g.createElement(E,v({},this.uploadProps,{onChange:this.onUploadChange.bind(this),fileList:this.state.fileList}),g.createElement(c["default"],{type:"plus"}),g.createElement("p",{className:"ant-upload-text"},"选择本地文件,或将文件拖拽到此区域上传"),g.createElement("p",{className:"ant-upload-hint"},"支持的格式：GeoJson 格式(.json), KML 格式(.kml), AutoCad DXF 格式(.dxf)"))))))}}]),t}(g.Component);t["default"]=w},741:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(){}function o(){return!0}function i(e){return{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.filename||e.name,size:e.size,type:e.type,uid:e.uid,response:e.response,error:e.error,percent:0,originFileObj:e}}function l(){var e=.1,t=.01,n=.98;return function(r){return r>=n?r:(r+=e,e-=t,.001>e&&(e=.001),100*r)}}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),c=r(u),f=n(742),p=r(f),d=n(718),h=r(d),m=n(748),y=r(m),v=n(752),b=r(v),g="ant-upload",E=c["default"].createClass({displayName:"AntUpload",getInitialState:function(){return{fileList:this.props.fileList||this.props.defaultFileList||[],dragState:"drop"}},onStart:function(e){if(this.recentUploadStatus!==!1){var t=void 0,n=this.state.fileList.concat();e.length>0?(t=e.map(function(e){return e=i(e),e.status="uploading",e}),n=n.concat(t)):(t=i(e),t.status="uploading",n.push(t)),this.onChange({file:t,fileList:n}),window.FormData||this.autoUpdateProgress(0,t)}},autoUpdateProgress:function(e,t){var n=this,r=l(),a=0;this.progressTimer=setInterval(function(){a=r(a),n.onProgress({percent:a},t)},200)},removeFile:function(e){var t=this.state.fileList,n=(0,b["default"])(e,t),r=t.indexOf(n);return-1!==r?(t.splice(r,1),t):null},onSuccess:function(e,t){this.clearProgressTimer();try{"string"==typeof e&&JSON.parse(e)}catch(n){return void this.onError(new Error("No response"),e,t)}var r=this.state.fileList,a=(0,b["default"])(t,r);a&&(a.status="done",a.response=e,this.onChange({file:a,fileList:r}))},onProgress:function(e,t){var n=this.state.fileList,r=(0,b["default"])(t,n);r&&(r.percent=e.percent,this.onChange({event:e,file:t,fileList:this.state.fileList}))},onError:function(e,t,n){this.clearProgressTimer();var r=this.state.fileList,a=(0,b["default"])(n,r);a.error=e,a.response=t,a.status="error",this.handleRemove(a)},beforeUpload:function(e){return this.recentUploadStatus=this.props.beforeUpload(e),this.recentUploadStatus},handleRemove:function(e){var t=this.removeFile(e);t&&this.onChange({file:e,fileList:t})},handleManualRemove:function(e){e.status="removed",this.handleRemove(e)},onChange:function(e){this.setState({fileList:e.fileList}),this.props.onChange(e)},getDefaultProps:function(){return{type:"select",name:"",multipart:!1,action:"",data:{},accept:"",onChange:a,beforeUpload:o,showUploadList:!0,listType:"text",className:""}},componentWillReceiveProps:function(e){"fileList"in e&&this.setState({fileList:e.fileList})},onFileDrop:function(e){this.setState({dragState:e.type})},clearProgressTimer:function(){clearInterval(this.progressTimer)},render:function(){var e=this.props.type||"select",t=(0,h["default"])({},this.props,{onStart:this.onStart,onError:this.onError,onProgress:this.onProgress,onSuccess:this.onSuccess,beforeUpload:this.beforeUpload}),n=void 0;if(this.props.showUploadList&&(n=c["default"].createElement(y["default"],{listType:this.props.listType,items:this.state.fileList,onRemove:this.handleManualRemove})),"drag"===e){var r=this.state.fileList.some(function(e){return"uploading"===e.status})?g+"-drag-uploading":"",a="dragover"===this.state.dragState?g+"-drag-hover":"";return c["default"].createElement("span",{className:this.props.className},c["default"].createElement("div",{className:g+" "+g+"-drag "+r+" "+a,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,onDragLeave:this.onFileDrop},c["default"].createElement(p["default"],t,c["default"].createElement("div",{className:g+"-drag-container"},this.props.children))),n)}return"select"===e?c["default"].createElement("span",{className:this.props.className},c["default"].createElement("div",{className:g+" "+g+"-select"},c["default"].createElement(p["default"],t,this.props.children)),n):void 0}});E.Dragger=c["default"].createClass({displayName:"Dragger",render:function(){return c["default"].createElement(E,s({},this.props,{type:"drag",style:{height:this.props.height}}))}}),t["default"]=E,e.exports=t["default"]},742:function(e,t,n){"use strict";e.exports=n(743)},743:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(){}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=r(o),l=n(744),s=r(l),u=n(747),c=r(u),f=i["default"].createClass({displayName:"Upload",propTypes:{forceAjax:o.PropTypes.bool,action:o.PropTypes.string,name:o.PropTypes.string,multipart:o.PropTypes.bool,onError:o.PropTypes.func,onSuccess:o.PropTypes.func,onProgress:o.PropTypes.func,onStart:o.PropTypes.func,data:o.PropTypes.object,accept:o.PropTypes.string,multiple:o.PropTypes.bool,beforeUpload:o.PropTypes.func,withCredentials:o.PropTypes.bool},getDefaultProps:function(){return{data:{},name:"file",forceAjax:!1,multipart:!1,onProgress:a,onStart:a,onError:a,onSuccess:a,multiple:!1,beforeUpload:null,withCredentials:!1}},render:function(){var e=this.props;return e.forceAjax||"undefined"!=typeof FormData?i["default"].createElement(s["default"],e):i["default"].createElement(c["default"],e)}});t["default"]=f,e.exports=t["default"]},744:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(745),o=r(a),i=n(1),l=r(i),s=n(746),u=r(s),c=l["default"].createClass({displayName:"AjaxUploader",propTypes:{multiple:i.PropTypes.bool,onStart:i.PropTypes.func,data:i.PropTypes.object,beforeUpload:i.PropTypes.func,withCredentials:i.PropTypes.bool},onChange:function(e){var t=e.target.files;this.uploadFiles(t)},onClick:function(){var e=this.refs.file;e&&(e.click(),e.value="")},onKeyDown:function(e){"Enter"===e.key&&this.onClick()},onFileDrop:function(e){if("dragover"===e.type)return e.preventDefault();var t=e.dataTransfer.files;this.uploadFiles(t),e.preventDefault()},uploadFiles:function(e){var t=e.length;if(t>0){for(var n=0;t>n;n++){var r=e.item(n);r.uid=(0,u["default"])(),this.upload(r)}this.props.multiple?this.props.onStart(Array.prototype.slice.call(e)):this.props.onStart(Array.prototype.slice.call(e)[0])}},upload:function(e){var t=this,n=this.props;if(!n.beforeUpload)return this.post(e);var r=n.beforeUpload(e);r&&r.then?r.then(function(){t.post(e)}):r!==!1&&this.post(e)},post:function(e){var t=this.props,n=t.data;"function"==typeof n&&(n=n()),(0,o["default"])({action:t.action,filename:t.name,file:e,data:n,withCredentials:t.withCredentials,onProgress:function(n){t.onProgress(n,e)},onSuccess:function(n){t.onSuccess(n,e)},onError:function(n,r){t.onError(n,r,e)}})},render:function(){var e={display:"none"},t=this.props;return l["default"].createElement("span",{onClick:this.onClick,onKeyDown:this.onKeyDown,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,role:"button",tabIndex:"0"},l["default"].createElement("input",{type:"file",ref:"file",style:e,accept:t.accept,multiple:this.props.multiple,onChange:this.onChange}),t.children)}});t["default"]=c,e.exports=t["default"]},745:function(e,t){"use strict";function n(e,t){var n="cannot post "+e.action+" "+t.status+"'",r=new Error(n);return r.status=t.status,r.method="post",r.url=e.action,r}function r(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(n){return t}}function a(e){if("undefined"!=typeof XMLHttpRequest){var t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var a=new FormData;a.append(e.filename,e.file),e.data&&Object.keys(e.data).map(function(t){a.append(t,e.data[t])}),t.onerror=function(t){e.onError(t)},t.onload=function(){return 200!==t.status?e.onError(n(e,t),r(t)):void e.onSuccess(r(t))},e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0),t.open("post",e.action,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.send(a)}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a,e.exports=t["default"]},746:function(e,t){"use strict";function n(){return"rc-upload-"+r+"-"+ ++a}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=+new Date,a=0;e.exports=t["default"]},747:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),i=n(153),l=r(i),s=n(746),u=r(s),c=n(186),f=r(c),p={position:"absolute",top:0,opacity:0,filter:"alpha(opacity=0)",left:0,zIndex:9999},d=o["default"].createClass({displayName:"IframeUploader",propTypes:{onStart:a.PropTypes.func,multiple:a.PropTypes.bool,children:a.PropTypes.any,data:a.PropTypes.object,action:a.PropTypes.string,name:a.PropTypes.string},componentDidMount:function(){this.updateIframeWH(),this.initIframe()},componentDidUpdate:function(){this.updateIframeWH()},onLoad:function(){if(this.loading){var e=this.props,t=void 0,n=this.file;try{var r=this.getIframeDocument(),a=r.getElementsByTagName("script")[0];a&&a.parentNode===r.body&&r.body.removeChild(a),t=r.body.innerHTML,e.onSuccess(t,n)}catch(o){(0,f["default"])(!1,"cross domain error for Upload. Maybe server should return document.domain script. see Note from https://github.com/react-component/upload"),t="cross-domain",e.onError(o,null,n)}this.enableIframe(),this.initIframe()}},onChange:function(){var e=this.getFormInputNode(),t=this.file={uid:(0,u["default"])(),name:e.value};this.props.onStart(this.getFileForMultiple(t));var n=this.getFormNode(),r=this.getFormDataNode(),a=this.props.data;"function"==typeof a&&(a=a());var o=[];for(var i in a)a.hasOwnProperty(i)&&o.push('<input name="'+i+'" value="'+a[i]+'"/>');r.innerHTML=o.join(""),n.submit(),r.innerHTML="",this.disabledIframe()},getIframeNode:function(){return this.refs.iframe},getIframeDocument:function(){return this.getIframeNode().contentDocument},getFormNode:function(){return this.getIframeDocument().getElementById("form")},getFormInputNode:function(){return this.getIframeDocument().getElementById("input")},getFormDataNode:function(){return this.getIframeDocument().getElementById("data")},getFileForMultiple:function(e){return this.props.multiple?[e]:e},getIframeHTML:function(e){var t="",n="";return e&&(t='<script>document.domain="'+e+'";</script>',n='<input name="_documentDomain" value="'+e+'" />'),'\n    <!DOCTYPE html>\n    <html>\n    <head>\n    <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n    <style>\n    body,html {padding:0;margin:0;border:0;overflow:hidden;}\n    </style>\n    '+t+'\n    </head>\n    <body>\n    <form method="post"\n    encType="multipart/form-data"\n    action="'+this.props.action+'" id="form" style="display:block;height:9999px;position:relative;overflow:hidden;">\n    <input id="input" type="file"\n     name="'+this.props.name+'"\n     style="position:absolute;top:0;right:0;height:9999px;font-size:9999px;cursor:pointer;"/>\n    '+n+'\n    <span id="data"></span>\n    </form>\n    </body>\n    </html>\n    '},initIframeSrc:function(){this.domain&&(this.getIframeNode().src="javascript:void((function(){\n        var d = document;\n        d.open();\n        d.domain='"+this.domain+"';\n        d.write('');\n        d.close();\n      })())")},initIframe:function(){var e=this.getIframeNode(),t=e.contentWindow,n=void 0;this.domain=this.domain||"",this.initIframeSrc();try{n=t.document}catch(r){this.domain=document.domain,this.initIframeSrc(),t=e.contentWindow,n=t.document}n.open("text/html","replace"),n.write(this.getIframeHTML(this.domain)),n.close(),this.getFormInputNode().onchange=this.onChange},enableIframe:function(){this.loading=!1,this.getIframeNode().style.display=""},disabledIframe:function(){this.loading=!0,this.getIframeNode().style.display="none"},updateIframeWH:function(){var e=l["default"].findDOMNode(this),t=this.getIframeNode();t.style.height=e.offsetHeight+"px",t.style.width=e.offsetWidth+"px"},render:function(){return o["default"].createElement("span",{style:{position:"relative",zIndex:0}},o["default"].createElement("iframe",{ref:"iframe",onLoad:this.onLoad,style:p}),this.props.children)}});t["default"]=d,e.exports=t["default"]},748:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),l=r(i),s=n(723),u=r(s),c=n(736),f=r(c),p=n(749),d=n(190),h=r(d),m="ant-upload",y=function(e,t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)};t["default"]=l["default"].createClass({displayName:"uploadList",getDefaultProps:function(){return{listType:"text",items:[],progressAttr:{strokeWidth:3,showInfo:!1}}},handleClose:function(e){this.props.onRemove(e)},componentDidUpdate:function(){var e=this;"picture"===this.props.listType&&this.props.items.forEach(function(t){"undefined"==typeof document||"undefined"==typeof window||!window.FileReader||!window.File||!t.originFileObj instanceof File||void 0!==t.thumbUrl||(t.thumbUrl="",y(t.originFileObj,function(n){t.thumbUrl=n,e.forceUpdate()}))})},render:function(){var e,t=this,n=this.props.items.map(function(e){var n,r=void 0,i=l["default"].createElement(f["default"],{type:"paper-clip"});"picture"===t.props.listType&&(i="uploading"===e.status||!e.thumbUrl&&!e.url?l["default"].createElement(f["default"],{className:m+"-list-item-thumbnail",type:"picture"}):l["default"].createElement("a",{className:m+"-list-item-thumbnail",href:e.url,target:"_blank"},l["default"].createElement("img",{src:e.thumbUrl||e.url,alt:e.name}))),"uploading"===e.status&&(r=l["default"].createElement("div",{className:m+"-list-item-progress"},l["default"].createElement(p.Line,o({},t.props.progressAttr,{percent:e.percent}))));var s=(0,h["default"])((n={},a(n,m+"-list-item",!0),a(n,m+"-list-item-"+e.status,!0),n));return l["default"].createElement("div",{className:s,key:e.uid},l["default"].createElement("div",{className:m+"-list-item-info"},i,l["default"].createElement("span",{className:m+"-list-item-name"},e.name),l["default"].createElement(f["default"],{type:"cross",onClick:t.handleClose.bind(t,e)})),r)}),r=(0,h["default"])((e={},a(e,m+"-list",!0),a(e,m+"-list-"+this.props.listType,!0),e));return l["default"].createElement("div",{className:r},l["default"].createElement(u["default"],{transitionName:m+"-margin-top"},n))}}),e.exports=t["default"]},749:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(750),o=n(1),i=r(o),l=n(718),s=r(l),u=n(736),c=r(u),f="ant-progress",p={normal:"#2db7f5",exception:"#ff6600",success:"#87d068"},d=i["default"].createClass({displayName:"Line",propTypes:{status:i["default"].PropTypes.oneOf(["normal","exception","active","success"]),showInfo:i["default"].PropTypes.bool,percent:i["default"].PropTypes.number,strokeWidth:i["default"].PropTypes.number},getDefaultProps:function(){return{percent:0,strokeWidth:10,status:"normal",format:"${percent}%",showInfo:!0}},render:function(){var e=(0,s["default"])({},this.props);100===parseInt(e.percent,10)&&(e.status="success");var t=void 0,n="",r="string"==typeof e.format?e.format.replace("${percent}",e.percent):e.format;e.showInfo===!0?t="exception"===e.status?i["default"].createElement("span",{className:f+"-line-text"},r):"success"===e.status?i["default"].createElement("span",{className:f+"-line-text"},i["default"].createElement(c["default"],{type:"check"})):i["default"].createElement("span",{className:f+"-line-text"},r):n=" "+f+"-line-wrap-full";var a={width:e.percent+"%",height:e.strokeWidth};return i["default"].createElement("div",{className:f+"-line-wrap clearfix status-"+e.status+n},t,i["default"].createElement("div",{className:f+"-line-outer"},i["default"].createElement("div",{className:f+"-line-inner"},i["default"].createElement("div",{className:f+"-line-bg",style:a}))))}}),h=i["default"].createClass({displayName:"Circle",propTypes:{status:i["default"].PropTypes.oneOf(["normal","exception","success"]),percent:i["default"].PropTypes.number,strokeWidth:i["default"].PropTypes.number,width:i["default"].PropTypes.number},getDefaultProps:function(){return{width:132,percent:0,strokeWidth:6,format:"${percent}%",status:"normal"}},render:function(){var e=(0,s["default"])({},this.props);100===parseInt(e.percent,10)&&(e.status="success");var t={width:e.width,height:e.width,fontSize:.16*e.width+6},n=void 0,r="string"==typeof e.format?e.format.replace("${percent}",e.percent):e.format;return n="exception"===e.status?i["default"].createElement("span",{className:f+"-circle-text"},r):"success"===e.status?i["default"].createElement("span",{className:f+"-circle-text"},i["default"].createElement(c["default"],{type:"check"})):i["default"].createElement("span",{className:f+"-circle-text"},r),i["default"].createElement("div",{className:f+"-circle-wrap status-"+e.status},i["default"].createElement("div",{className:f+"-circle-inner",style:t},i["default"].createElement(a.Circle,{percent:e.percent,strokeWidth:e.strokeWidth,strokeColor:p[e.status],trailColor:"#e9e9e9"}),n))}});t["default"]={Line:d,Circle:h},e.exports=t["default"]},750:function(e,t,n){"use strict";e.exports=n(751)},751:function(e,t,n){"use strict";var r=n(718),a=n(1),o={strokeWidth:1,strokeColor:"#3FC7FA",trailWidth:1,trailColor:"#D9D9D9"},i=a.createClass({displayName:"Line",render:function(){var e=r({},this.props),t={strokeDasharray:"100px, 100px",strokeDashoffset:100-e.percent+"px",transition:"stroke-dashoffset 0.6s ease 0s, stroke 0.6s linear"};["strokeWidth","strokeColor","trailWidth","trailColor"].forEach(function(t){return"trailWidth"===t&&!e.trailWidth&&e.strokeWidth?void(e.trailWidth=e.strokeWidth):"strokeWidth"===t&&e.strokeWidth&&(!parseFloat(e.strokeWidth)||parseFloat(e.strokeWidth)>100||parseFloat(e.strokeWidth)<0)?void(e[t]=o[t]):void(e[t]||(e[t]=o[t]))});var n=e.strokeWidth,i=n/2,l=100-n/2,s="M "+i+","+i+" L "+l+","+i,u="0 0 100 "+n;return a.createElement("svg",{className:"rc-progress-line",viewBox:u,preserveAspectRatio:"none"},a.createElement("path",{className:"rc-progress-line-trail",d:s,strokeLinecap:"round",stroke:e.trailColor,strokeWidth:e.trailWidth,fillOpacity:"0"}),a.createElement("path",{className:"rc-progress-line-path",d:s,strokeLinecap:"round",stroke:e.strokeColor,strokeWidth:e.strokeWidth,fillOpacity:"0",style:t}))}}),l=a.createClass({displayName:"Circle",render:function(){var e=r({},this.props),t=e.strokeWidth,n=50-t/2,i="M 50,50 m 0,-"+n+"\n     a "+n+","+n+" 0 1 1 0,"+2*n+"\n     a "+n+","+n+" 0 1 1 0,-"+2*n,l=2*Math.PI*n,s={strokeDasharray:l+"px "+l+"px",strokeDashoffset:(100-e.percent)/100*l+"px",transition:"stroke-dashoffset 0.6s ease 0s, stroke 0.6s ease"};return["strokeWidth","strokeColor","trailWidth","trailColor"].forEach(function(t){return"trailWidth"===t&&!e.trailWidth&&e.strokeWidth?void(e.trailWidth=e.strokeWidth):void(e[t]||(e[t]=o[t]))}),a.createElement("svg",{className:"rc-progress-circle",viewBox:"0 0 100 100"},a.createElement("path",{className:"rc-progress-circle-trail",d:i,stroke:e.trailColor,strokeWidth:e.trailWidth,fillOpacity:"0"}),a.createElement("path",{className:"rc-progress-circle-path",d:i,strokeLinecap:"round",stroke:e.strokeColor,strokeWidth:e.strokeWidth,fillOpacity:"0",style:s}))}});e.exports={Line:i,Circle:l}},752:function(e,t){"use strict";function n(e,t){var n=e.uid?"byUid":"byName",r=t.filter(function(t){return"byName"===n?t.name===e.name:t.uid===e.uid})[0];return r}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,e.exports=t["default"]},796:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(797),u=r(s),c=n(803),f=r(c),p=n(1),d=(n(153),function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){return p.createElement("div",null,p.createElement(f["default"],{
ref:"toolbar",parent:this}),p.createElement(u["default"],{ref:"map",center:this.props.center,id:this.props.id.$oid,extent:this.props.extent,source:this.props.source,meta:this.props.meta,title:this.props.title}))}}]),t}(p.Component));t["default"]=d},797:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(798),u=r(s),c=n(799),f=r(c),p=n(1),d=(n(153),function(e){function t(){a(this,t);var e=o(this,Object.getPrototypeOf(t).call(this));return e.state={map:null},e.format=new ol.format.KML,e}return i(t,e),l(t,[{key:"registerKeyBoardEvent",value:function(){var e=this;document.onkeydown=function(t){var n=null;if(n=window.event?t.keyCode:w.which,27==n){var r=e.map.getInteractions();r.forEach(function(e){e instanceof ol.interaction.Draw&&"Point"!=e.get("type")&&e.removeLastPoint()})}else if(90==n&&t.ctrlKey){var a=e.history.toPrevState();a&&e.editLayer&&(a.feature?e.editLayer.getSource().removeFeature(a.feature):a.startfeatures&&a.endfeatures&&(a.endfeatures.forEach(function(t){e.editLayer.getSource().removeFeature(t)}),e.editLayer.getSource().addFeatures(a.startfeatures.getArray()),e.selectedFeatures.clear()))}else if(88==n&&t.ctrlKey){var o=e.history.toNextState();o&&e.editLayer&&(o.feature?e.editLayer.getSource().addFeature(o.feature):o.startfeatures&&o.endfeatures&&(o.startfeatures.forEach(function(t){e.editLayer.getSource().removeFeature(t)}),e.editLayer.getSource().addFeatures(o.endfeatures.getArray()),e.selectedFeatures.clear()))}},this["int"]=setInterval(this.history.autoSave.bind(this.history),3e4),window.onbeforeunload=function(t){e.history.autoSave()}}},{key:"componentWillUnmount",value:function(){clearInterval(this["int"])}},{key:"componentDidMount",value:function(){var e=this;this.map=new ol.Map({target:this.refs.mapDoc,controls:ol.control.defaults({attributionOptions:{collapsible:!1}}),view:new ol.View({center:this.props.center,projection:"EPSG:3857",zoom:4})});var t=proj4.defs(this.props.meta.proj),n="EPSG:3857";void 0==t&&"unknown"!==this.props.meta.proj&&(proj4.defs(this.props.title,this.props.meta.proj),n=this.props.title),this.format=new ol.format.GeoJSON({defaultDataProjection:n}),this.vectorSource=new ol.source.Vector({url:this.props.source,format:this.format,wrapX:!1}),this.vectorLayer=new ol.layer.Vector({name:"Default",source:this.vectorSource,style:u["default"]}),this.editLayer=null,this.contours=null,this.select=new ol.interaction.Select,this.map.addInteraction(this.select),this.select.setActive(!1),this.selectedFeatures=this.select.getFeatures(),this.dragBox=new ol.interaction.DragBox({condition:ol.events.condition.platformModifierKeyOnly}),this.modify=new ol.interaction.Modify({features:this.select.getFeatures()}),this.modify.on("modifyend",function(t){e.history.onModifyEnd(t)}),this.modify.on("modifystart",function(t){e.history.onModifyStart(t)}),this.map.addInteraction(this.dragBox),this.map.addInteraction(this.modify),this.history=new f["default"](this.map,this.props.id),this.dragBox.on("boxend",function(){if(null!=e.editLayer){var t=e.dragBox.getGeometry().getExtent();e.editLayer.getSource().forEachFeatureIntersectingExtent(t,function(t){e.selectedFeatures.push(t)})}}),this.dragBox.on("boxstart",function(){e.selectedFeatures.clear()}),this.map.on("dblclick",function(){e.selectedFeatures.clear()});var r=ol.proj.transformExtent(this.props.extent,n,"EPSG:3857");this.map.addLayer(this.vectorLayer),this.map.addControl(new ol.control.ScaleLine),this.map.addControl(new ol.control.MousePosition),this.map.getView().fit(r,this.map.getSize()),this.map.render(),this.setState({map:this.map}),this.registerKeyBoardEvent()}},{key:"render",value:function(){return p.createElement("div",{className:"map-editor-container",ref:"mapDoc"})}}]),t}(p.Component));t["default"]=d},798:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),stroke:new ol.style.Stroke({color:"rgba(0,0,0,1)",width:1}),image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(0,0,0,1)"}),radius:2})})];t["default"]=n},799:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(737),i=r(o),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(800),u=r(s),c=function(){function e(t,n){var r=arguments.length<=2||void 0===arguments[2]?16:arguments[2];a(this,e),this.prevStates=new u["default"](r),this.nextStates=new u["default"](r),this.beforeStates=new u["default"](r),this.endStates=new u["default"](r),this.maxSize=r,this.map=t,this.id=n}return l(e,[{key:"clear",value:function(){this.nextStates.clear(),this.prevStates.clear()}},{key:"autoSave",value:function(){var e=i["default"].info("正在自动保存文件!"),t=this.map.getLayers(),n=[];t.forEach(function(e){var t=e.getSource();t.forEachFeature(function(e){n.push(e)})});var r=new ol.format.GeoJSON({defaultDataProjection:"EPSG:3857"}).writeFeatures(n);$.post("/karte/auto_save",{id:this.id,json_data:r},function(t){"success"==t.msg?(e(),i["default"].info("自动保存文件成功!")):(e(),i["default"].info("自动保存文件失败!"))}).error(function(){e(),i["default"].info("自动保存文件失败!")})}},{key:"onDrawEnd",value:function(e){var t={type:e.type,target:e.target,feature:e.feature};console.log(t),this.prevStates.pushBack(t),this.nextStates.clear()}},{key:"onModifyStart",value:function(e){var t=new ol.Collection;e.features.forEach(function(e){t.push(e.clone())});var n={type:e.type,target:e.target,startfeatures:t};if(this.hasPrevState()){var r=this.prevStates.popBack();"modifyend"==r.type&&(r.endfeatures=t,this.prevStates.pushBack(r))}this.prevStates.pushBack(n),this.nextStates.clear()}},{key:"onModifyEnd",value:function(e){var t=void 0,n=new ol.Collection;return e.features.forEach(function(e){n.push(e)}),this.hasPrevState()?(t=this.prevStates.popBack(),t.type=e.type,t.endfeatures=n,this.prevStates.pushBack(t),this.nextStates.clear(),void 0):void console.log("not find start state")}},{key:"hasPrevState",value:function(){return this.prevStates.size()>0}},{key:"hasNextState",value:function(){return this.nextStates.size()>0}},{key:"toPrevState",value:function(){if(this.hasPrevState()){var e=this.prevStates.popBack();return this.nextStates.pushBack(e),e}}},{key:"toNextState",value:function(){if(this.hasNextState()){var e=this.nextStates.popBack();return this.prevStates.pushBack(e),e}}}]),e}();t["default"]=c},800:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(801),l=r(i),s=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?128:arguments[0];a(this,e),this.cap=t,this.list=new l["default"]}return o(e,[{key:"overSize",value:function(){return this.size()>=this.cap}},{key:"pushBack",value:function(e){this.overSize()&&this.popFont(),this.list.add(e)}},{key:"pushFont",value:function(e){this.overSize()&&this.popBack(),this.list.add(e,0)}},{key:"popBack",value:function(){var e;return 0!==this.list.size()?(e=this.list.last(),this.list.removeAtIndex(this.size()-1),e):null}},{key:"popFont",value:function(){var e;return 0!==this.list.size()?(e=this.list.first(),this.list.removeAtIndex(0),e):null}},{key:"peek",value:function(){return 0!==this.list.size()?this.list.first():null}},{key:"clear",value:function(){this.list.clear()}},{key:"include",value:function(e,t){return this.list.include(e,t)}},{key:"size",value:function(){return this.list.size()}}]),e}();t["default"]=s},801:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(802),l=r(i),s=function(){function e(){a(this,e),this.nElement=0,this.firstNode=null,this.lastNode=null}return o(e,[{key:"add",value:function(e,t){var n=void 0,r=void 0;return l["default"].isUnfefined(t)&&(t=this.nElement),0>t||t>this.nElement||l["default"].isUnfefined(e)?!1:(n={element:e,next:null},0===this.nElement?(this.firstNode=n,this.lastNode=n):t===this.nElement?(this.lastNode.next=n,this.lastNode=n):0===t?(n.next=this.firstNode,this.firstNode=n):(r=this.nodeAtIndex(t-1),n.next=r.next,r.next=n),this.nElement+=1,!0)}},{key:"remove",value:function(e,t){var n=t||l["default"].defaultEqual,r=this.firstNode,a=null;if(this.nElement<1||l["default"].isUnfefined(e))return!1;for(;null!==r;){if(n(r.element,e))return r===this.firstNode?(this.firstNode=this.firstNode.next,r===this.lastNode&&(this.lastNode=null)):r===this.lastNode?(this.lastNode=a,a.next=r.next,r.next=null):(a.next=r.next,r.next=null),this.nElement-=1,!0;a=r,r=r.next}return!1}},{key:"removeAtIndex",value:function(e){var t=void 0,n=void 0;return 0>e||e>=this.nElement?null:(1===this.nElement?(t=this.firstNode.element,this.firstNode=null,this.lastNode=null):(n=this.nodeAtIndex(e-1),null===n?(t=this.firstNode.element,this.firstNode=this.firstNode.next):n.next===this.lastNode?(t=this.lastNode.element,this.lastNode=n):(t=n.next.element,n.next=n.next.next)),this.nElement-=1,t)}},{key:"clear",value:function(){this.nElement=0,this.firstNode=null,this.lastNode=null}},{key:"nodeAtIndex",value:function(e){var t=void 0,n=void 0;if(0>e||e>=this.nElement)return null;if(e===this.nElement-1)return this.lastNode;for(t=this.firstNode,n=0;e>n;n++)t=t.next;return t}},{key:"elementAtIndex",value:function(e){var t=this.nodeAtIndex(e);return null===t?null:t.element}},{key:"include",value:function(e,t){return this.indexOf(e,t)>=0}},{key:"indexOf",value:function(e,t){var n=t||l["default"].defaultEqual,r=this.firstNode,a=0;if(l["default"].isUnfefined(e))return-1;for(;null!==r;){if(n(r.element,e))return a;a+=1,r=r.next}return-1}},{key:"forEach",value:function(e){for(var t=this.firstNode;null!==t&&e(t.element)!==!1;)t=t.next}},{key:"first",value:function(){return null!==this.firstNode?this.firstNode.element:null}},{key:"last",value:function(){return null!==this.lastNode?this.lastNode.element:null}},{key:"size",value:function(){return this.nElement}}]),e}();t["default"]=s},802:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){n(this,e)}return r(e,null,[{key:"defaultEqual",value:function(e,t){return e===t}},{key:"defaultCompare",value:function(e,t){return t>e?-1:e===t?0:1}},{key:"isFunction",value:function(e){return"function"==typeof e}},{key:"isUnfefined",value:function(e){return void 0===e}},{key:"isString",value:function(e){return"[object String]"===Object.prototype.toString.call(e)}}]),e}();t["default"]=a},803:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(737),s=r(l),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(154),f=n(804),p=r(f),d=n(805),h=r(d),m=n(813),y=r(m),v=n(814),b=r(v),g=n(823),E=r(g),w=n(824),k=r(w),P=n(825),C=r(P),O=n(831),N=r(O),x=n(798),T=r(x),_=n(835),j=r(_),S=n(836),M=r(S),I=n(1),L=(n(153),function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={type:null,draw:null,editable:!1,prevLayer:null,editLayer:null,layers:null},i=n,o(r,i)}return i(t,e),u(t,[{key:"changeDrawType",value:function(e){if(null==e)return this.setState({type:e}),this.setMousePointer("pointer"),void(null!=this.state.draw&&this.getMap().map.removeInteraction(this.state.draw));if(!this.state.editLayer)return void s["default"].info("还没有选择任何图层!",.5);this.setMousePointer("crosshair"),this.setState({type:e}),null!=this.state.draw&&this.getMap().map.removeInteraction(this.state.draw);var t=this.getInteraction(e);t&&(this.setState({draw:t}),this.getMap().map.addInteraction(t))}},{key:"handleStartModify",value:function(){var e=this;if(null!=this.state.editLayer)return this.setState({editLayer:null}),this.setState({prevLayer:this.state.editLayer}),this.getMap().editLayer=null,this.getMap().selectedFeatures.clear(),this.state.draw&&this.getMap().map.removeInteraction(this.state.draw),void this.setMousePointer("pointer");var t=this.getMap().map,n=t.getLayers();this.setState({layers:n}),this.refs.selectLayer.open(function(t){e.state.prevLayer!=t&&e.getMap().history.clear(),e.setState({editLayer:t}),e.getMap().editLayer=t})}},{key:"componentDidMount",value:function(){this.setMousePointer("pointer")}},{key:"getMap",value:function(){return this.props.map.refs.map}},{key:"getMapNode",value:function(){return this.props.map.refs.map?this.props.map.refs.map.refs.mapDoc:void 0}},{key:"setMousePointer",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"pointer":arguments[0],t=this.getMapNode();t&&(t.style.cursor=e)}},{key:"getInteraction",value:function(e){var t=this;if(null!=e){if("null"==e)return null;var n,r;if("Square"==e?(e="Circle",n=ol.interaction.Draw.createRegularPolygon(4)):"Box"==e&&(e="LineString",r=2,n=function(e,t){t||(t=new ol.geom.Polygon(null));var n=e[0],r=e[1];return t.setCoordinates([[n,[n[0],r[1]],r,[r[0],n[1]],n]]),t}),this.state.editLayer){var a=new ol.interaction.Draw({source:this.state.editLayer.getSource(),type:e,geometryFunction:n,maxPoints:r,style:T["default"]});return a.setProperties({type:e}),a.on("drawend",function(e){t.getMap().history.onDrawEnd(e)}),a}}return null}},{key:"render",value:function(){return I.createElement("div",{className:"panel panel-default"},I.createElement("div",{className:"panel-body tool-panel"},I.createElement(c.ButtonGroup,null,I.createElement(c.Button,{onClick:this.handleStartModify.bind(this),className:"btn-tool  btn-app btn-flat"},I.createElement("i",{className:"fa fa-pencil-square-o"}),null==this.state.editLayer?"选择编辑图层":"停止编辑"),I.createElement(c.Button,{onClick:this.changeDrawType.bind(this,null),id:"null",className:"btn-tool  btn-app btn-flat"},I.createElement("i",{className:"fa fa-arrows-alt"}),"浏览"),I.createElement(c.Button,{onClick:this.changeDrawType.bind(this,"Point"),id:"Point",className:"btn-tool  btn-app btn-flat"},I.createElement("i",{className:"fa fa-dot-circle-o"}),"画点"),I.createElement(c.Button,{onClick:this.changeDrawType.bind(this,"LineString"),id:"LineString",className:"btn-tool btn-app btn-flat"},I.createElement("i",{className:"fa fa-vine"}),"画线"),I.createElement(c.Button,{onClick:this.changeDrawType.bind(this,"Polygon"),id:"Polygon",className:"btn-tool  btn-app btn-flat"},I.createElement("i",{className:"fa fa-square"}),"画面"))),I.createElement(b["default"],{ref:"selectLayer",layers:this.state.layers}))}}]),t}(I.Component)),F=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={data:null,triangle:null,triangleLayer:null,contourLayer:null,layers:null,zMin:Number.NEGATIVE_INFINITY,zMax:Number.POSITIVE_INFINITY},i=n,o(r,i)}return i(t,e),u(t,[{key:"handleloadFile",value:function(){this.refs.reader.open(this.handleFileReaded.bind(this))}},{key:"handleFileReaded",value:function(e){this.setState({data:e});var t=E["default"].read(e),n=new ol.layer.Vector({name:"高程点",source:new ol.source.Vector({features:t}),style:T["default"]}),r=n.getSource().getExtent();this.getMap().map.addLayer(n),this.getMap().map.getView().fit(r,this.getMap().map.getSize())}},{key:"_dulaunay",value:function(e){if(null!=this.state.triangleLayer&&this.getMap().map.removeLayer(this.state.triangleLayer),null!=e){var t=E["default"].readFeatures(e);if(t.length<3)return void s["default"].error("选择的离散点太少,无法生成三角网!",2);for(var n=k["default"].triangulate(t),r=new ol.Collection,a=[],o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,l=0;l<n.length;){var u=t[n[l++]],c=t[n[l++]],f=t[n[l++]];a.push([{x:u[0],y:u[1],z:u[2]},{x:c[0],y:c[1],z:c[2]},{x:f[0],y:f[1],z:f[2]}]),o=u[2]<o?u[2]:o,o=c[2]<o?c[2]:o,o=f[2]<o?f[2]:o,i=u[2]>i?u[2]:i,i=c[2]>i?c[2]:i,i=f[2]>i?f[2]:i;var p=new ol.Feature({geometry:new ol.geom.Polygon([[u,c,f]],"XYZ")});r.push(p)}var d=new ol.layer.Vector({name:"三角网",source:new ol.source.Vector({features:r}),style:T["default"]}),h=d.getSource().getExtent();this.getMap().map.addLayer(d),this.getMap().map.getView().fit(h,this.getMap().map.getSize()),this.setState({triangle:a,zMin:o,zMax:i,triangleLayer:d}),console.log([o,i])}}},{key:"handleDulaunay",value:function(){var e=this.getMap().map.getLayers();this.setState({layers:e}),this.refs.triSetter.open(this._dulaunay.bind(this))}},{key:"_contour",value:function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"0":arguments[1];if(null!=this.state.triangle){var n=new N["default"](this.state.triangle,this.state.zMin,this.state.zMax,e),r=n.contourLineTrace(),a=r;switch(t){case"0":break;case"1":a=C["default"].b_spline(r);break;case"2":a=C["default"].cardinal_spline(r)}r=a;for(var o=new ol.Collection,i=0;i<r.length;i++){for(var l=new ol.geom.LineString([],"XYZ"),u=0;u<r[i].listPoint.length;u++){var c=r[i].listPoint[u];c?l.appendCoordinate([c.x,c.y,c.z]):console.log(i,u)}if(1==r[i].type){var f=r[i].listPoint[0];f?l.appendCoordinate([f.x,f.y,f.z]):console.log(i)}var p=new ol.Feature({geometry:l});o.push(p),r[i].feature=p}if(r.length>0){var d=new ol.layer.Vector({name:"等高线",source:new ol.source.Vector({features:o}),style:T["default"]}),h=d.getSource().getExtent();null!=this.state.triangleLayer&&this.state.triangleLayer.setVisible(!1),this.getMap().contours=r,this.getMap().map.addLayer(d),this.getMap().map.getView().fit(h,this.getMap().map.getSize()),this.setState({contourLayer:d})}else s["default"].info("未追踪到等高线!",2)}else s["default"].warn("还没有生成三角网!",2)}},{key:"handleContour",value:function(){this.refs.contourSetter.open(this._contour.bind(this))}},{key:"getMap",value:function(){return this.props.map.refs.map}},{key:"render",value:function(){return I.createElement("div",{className:"panel panel-default"},I.createElement("div",{className:"panel-body tool-panel"},I.createElement(c.ButtonGroup,null,I.createElement(c.Button,{onClick:this.handleloadFile.bind(this),className:"btn-tool  btn-app btn-flat"},"导入点文件"),I.createElement(c.Button,{onClick:this.handleDulaunay.bind(this),className:"btn-tool  btn-app btn-flat"},"生成不规则三角网"),I.createElement(c.Button,{onClick:this.handleContour.bind(this),className:"btn-tool  btn-app btn-flat"},"生成等高线"))),I.createElement(p["default"],{ref:"reader"}),I.createElement(j["default"],{ref:"triSetter",layers:this.state.layers,map:this.props.map}),I.createElement(M["default"],{ref:"contourSetter",map:this.props.map,zMin:this.state.zMin,zMax:this.state.zMax}))}}]),t}(I.Component),D=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={layers:null,contours:null},i=n,o(r,i)}return i(t,e),u(t,[{key:"layerInfo",value:function(){var e=this.getMap().map.getLayers();this.setState({layers:e}),this.refs.layerView.open()}},{key:"contourInfo",value:function(){var e=this.getMap().contours;null!=e?(this.setState({contours:e}),this.refs.contourView.open()):s["default"].info("还没有生成等高线!",2)}},{key:"getMap",value:function(){return this.props.map.refs.map}},{key:"render",value:function(){return I.createElement("div",{className:"panel panel-default"},I.createElement("div",{className:"panel-body tool-panel"},I.createElement(c.ButtonGroup,null,I.createElement(c.Button,{onClick:this.layerInfo.bind(this),className:"btn-tool  btn-app btn-flat"},"图层信息"),I.createElement(c.Button,{onClick:this.contourInfo.bind(this),className:"btn-tool  btn-app btn-flat"},"等高线信息"))),I.createElement(h["default"],{ref:"layerView",layers:this.state.layers,map:this.props.map}),I.createElement(y["default"],{ref:"contourView",contours:this.state.contours,map:this.props.map}))}}]),t}(I.Component),z=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){return I.createElement("div",{className:"tool-container"},I.createElement(c.Tabs,{defaultActiveKey:1},I.createElement(c.Tab,{eventKey:1,title:"绘图"},I.createElement(L,{map:this.props.parent})),I.createElement(c.Tab,{eventKey:2,title:"等高线"},I.createElement(F,{map:this.props.parent})),I.createElement(c.Tab,{eventKey:3,title:"数据"},I.createElement(D,{map:this.props.parent}))))}}]),t}(I.Component);t["default"]=z},804:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(691),s=r(l),u=n(736),c=r(u),f=n(737),p=r(f),d=n(741),h=r(d),m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=(n(154),n(1)),b=(n(153),h["default"].Dragger),g=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={showModal:!1,loading:!1,data:null,callback:null,fileList:[]},r.uploadProps={name:"file",showUploadList:!0,action:"/karte/load_text_data"},i=n,o(r,i)}return i(t,e),y(t,[{key:"open",value:function(e){this.setState({showModal:!0,callback:e})}},{key:"close",value:function(){this.setState({showModal:!1})}},{key:"onUploadChange",value:function(e){var t=e.file,n=e.fileList;n=n.slice(-1),"done"==t.status?t.response.data?this.setState({data:t.response.data}):(this.setState({data:null}),p["default"].info("上传的文件格式错误!!",3),n=n.filter(function(e){return!e.response||"failed"!==e.response.msg})):this.setState({data:null}),this.setState({fileList:n})}},{key:"read",value:function(){return this.state.data?(null!=this.state.callback&&this.state.callback(this.state.data),this.close(),!0):(p["default"].info("还未读取到离散点文件!",3),!1)}},{key:"render",value:function(){return v.createElement(s["default"],{title:"读取文件",visible:this.state.showModal,onCancel:this.close.bind(this),onOk:this.read.bind(this)},v.createElement("div",{className:"modal-body"},v.createElement("div",{className:"form-group",style:{height:160}},v.createElement(b,m({},this.uploadProps,{onChange:this.onUploadChange.bind(this),fileList:this.state.fileList}),v.createElement(c["default"],{type:"plus"}),v.createElement("p",{className:"ant-upload-text"},"选择本地文件,或将文件拖拽到此区域上传"),v.createElement("p",{className:"ant-upload-hint"},"支持的格式：txt , dat")))))}}]),t}(v.Component);t["default"]=g},805:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(691),s=r(l),u=n(806),c=r(u),f=n(810),p=r(f),d=n(737),h=r(d),m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=n(154),b=n(1),g=(n(153),function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={showModal:!1,loading:!1,callback:null},i=n,o(r,i)}return i(t,e),y(t,[{key:"open",value:function(e){this.setState({showModal:!0,callback:e})}},{key:"close",value:function(){this.setState({showModal:!1})}},{key:"updateLayers",value:function(){this.setState({showModal:!1})}},{key:"changeVisible",value:function(e,t){e.setVisible(t),this.setState({visible:t})}},{key:"deleteLayer",value:function(e){var t=this.props.map.refs.map.map;this.props.layers&&this.props.layers.getLength()>1?t.removeLayer(e):h["default"].warn("最后一个图层无法删除!",2),this.setState({visible:!0})}},{key:"renderLayerList",value:function(){var e=this;if(null!=this.props.layers){var t=function(){var t=[];return e.props.layers.forEach(function(n,r,a){var o=n.getStyle()[0],i=o.getStroke(),l=o.getFill();t.push(b.createElement("tr",{key:r},b.createElement("td",null,n.get("name")||"Undefined"),b.createElement("td",null,b.createElement(p["default"],{checked:n.getVisible(),onChange:e.changeVisible.bind(e,n)})),b.createElement("td",null,b.createElement("div",{style:{width:60,height:30,backgroundColor:i.getColor(),border:"1px solid #ddd"}})),b.createElement("td",null,b.createElement("div",{style:{width:60,height:30,backgroundColor:l.getColor(),border:"1px solid #ddd"}})),b.createElement("td",null,"  ",b.createElement(c["default"],{title:"确定要删除这个图层吗？",onConfirm:e.deleteLayer.bind(e,n),onCancel:function(){}},b.createElement("a",{href:"javascript:(0)",style:{color:"#c7254e",fontSize:12}},"删除")))))}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":m(t)))return t.v}}},{key:"render",value:function(){return b.createElement(s["default"],{title:"图层信息",visible:this.state.showModal,onCancel:this.close.bind(this),onOk:this.updateLayers.bind(this),width:800},b.createElement(v.Table,null,b.createElement("thead",null,b.createElement("tr",null,b.createElement("th",null,"图层名"),b.createElement("th",null,"显示状态"),b.createElement("th",null,"边框颜色"),b.createElement("th",null,"填充颜色"),b.createElement("th",null))),b.createElement("tbody",null,this.renderLayerList())))}}]),t}(b.Component));t["default"]=g},806:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),i=n(807),l=r(i),s=n(736),u=r(s),c=n(732),f=r(c),p="ant-popover",d=function(){},h={top:"zoom-down",bottom:"zoom-up",left:"zoom-right",right:"zoom-left",topLeft:"zoom-down",bottomLeft:"zoom-up",leftTop:"zoom-right",rightTop:"zoom-left",topRight:"zoom-down",bottomRight:"zoom-up",leftBottom:"zoom-right",rightBottom:"zoom-left"};t["default"]=o["default"].createClass({displayName:"popconfirm",getInitialState:function(){return{visible:!1}},getDefaultProps:function(){return{transitionName:"",placement:"top",trigger:"click",overlayStyle:{},onConfirm:d,onCancel:d,okText:"确定",cancelText:"取消",onVisibleChange:function(){}}},componentWillReceiveProps:function(e){"visible"in e&&this.setState({visible:e.visible})},confirm:function(){this.setVisible(!1),this.props.onConfirm.call(this)},cancel:function(){this.setVisible(!1),this.props.onCancel.call(this)},onVisibleChange:function(e){this.setVisible(e),this.props.onVisibleChange(e)},setVisible:function(e){"visible"in this.props||this.setState({visible:e})},render:function(){var e=this.props,t=e.title,n=e.okText,r=e.cancelText,a=e.placement,i=e.overlayStyle,s=e.trigger,c=o["default"].createElement("div",null,o["default"].createElement("div",{className:p+"-content"},o["default"].createElement("p",{className:p+"-message"},o["default"].createElement(u["default"],{type:"exclamation-circle"}),t),o["default"].createElement("div",{className:p+"-buttons"},o["default"].createElement(f["default"],{onClick:this.cancel,type:"ghost",size:"small"},r),o["default"].createElement(f["default"],{onClick:this.confirm,type:"primary",size:"small"},n)))),d=h[a];return o["default"].createElement(l["default"],{placement:a,overlayStyle:i,prefixCls:p,onVisibleChange:this.onVisibleChange,transitionName:d,visible:this.state.visible,trigger:s,overlay:c},this.props.children)}}),e.exports=t["default"]},807:function(e,t,n){"use strict";e.exports=n(808)},808:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){
var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(1),l=r(i),s=n(809),u=n(778),c=r(u),f=l["default"].createClass({displayName:"Tooltip",propTypes:{trigger:i.PropTypes.any,children:i.PropTypes.any,defaultVisible:i.PropTypes.bool,visible:i.PropTypes.bool,placement:i.PropTypes.string,transitionName:i.PropTypes.string,animation:i.PropTypes.any,onVisibleChange:i.PropTypes.func,afterVisibleChange:i.PropTypes.func,overlay:i.PropTypes.node.isRequired,overlayStyle:i.PropTypes.object,overlayClassName:i.PropTypes.string,prefixCls:i.PropTypes.string,mouseEnterDelay:i.PropTypes.number,mouseLeaveDelay:i.PropTypes.number,getTooltipContainer:i.PropTypes.func,destroyTooltipOnHide:i.PropTypes.bool,align:i.PropTypes.shape({offset:i.PropTypes.array,targetOffset:i.PropTypes.array}),arrowContent:i.PropTypes.any},getDefaultProps:function(){return{prefixCls:"rc-tooltip",mouseEnterDelay:0,destroyTooltipOnHide:!1,mouseLeaveDelay:.1,align:{},placement:"right",trigger:["hover"],arrowContent:null}},getPopupElement:function(){var e=this.props,t=e.arrowContent,n=e.overlay,r=e.prefixCls;return[l["default"].createElement("div",{className:r+"-arrow",key:"arrow"},t),l["default"].createElement("div",{className:r+"-inner",key:"content"},n)]},getPopupDomNode:function(){return this.refs.trigger.popupDomNode},render:function(){var e=this.props,t=e.overlayClassName,n=e.trigger,r=e.mouseEnterDelay,i=e.mouseLeaveDelay,u=e.overlayStyle,f=e.prefixCls,p=e.children,d=e.onVisibleChange,h=e.transitionName,m=e.animation,y=e.placement,v=e.align,b=e.destroyTooltipOnHide,g=e.defaultVisible,E=e.getTooltipContainer,w=a(e,["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","transitionName","animation","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer"]),k=o({},w);return"visible"in this.props&&(k.popupVisible=this.props.visible),l["default"].createElement(c["default"],o({popupClassName:t,ref:"trigger",prefixCls:f,popup:this.getPopupElement(),action:n,builtinPlacements:s.placements,popupPlacement:y,popupAlign:v,getPopupContainer:E,onPopupVisibleChange:d,popupTransitionName:h,popupAnimation:m,defaultPopupVisible:g,destroyPopupOnHide:b,mouseLeaveDelay:i,popupStyle:u,mouseEnterDelay:r},k),p)}});t["default"]=f,e.exports=t["default"]},809:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={adjustX:1,adjustY:1},r=[0,0],a={left:{points:["cr","cl"],overflow:n,offset:[-4,0],targetOffset:r},right:{points:["cl","cr"],overflow:n,offset:[4,0],targetOffset:r},top:{points:["bc","tc"],overflow:n,offset:[0,-4],targetOffset:r},bottom:{points:["tc","bc"],overflow:n,offset:[0,4],targetOffset:r},topLeft:{points:["bl","tl"],overflow:n,offset:[0,-4],targetOffset:r},leftTop:{points:["tr","tl"],overflow:n,offset:[-3,0],targetOffset:r},topRight:{points:["br","tr"],overflow:n,offset:[0,-4],targetOffset:r},rightTop:{points:["tl","tr"],overflow:n,offset:[4,0],targetOffset:r},bottomRight:{points:["tr","br"],overflow:n,offset:[0,4],targetOffset:r},rightBottom:{points:["bl","br"],overflow:n,offset:[4,0],targetOffset:r},bottomLeft:{points:["tl","bl"],overflow:n,offset:[0,4],targetOffset:r},leftBottom:{points:["br","bl"],overflow:n,offset:[-4,0],targetOffset:r}};t.placements=a,t["default"]=a},810:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(811),l=r(i),s=n(1),u=r(s),c=n(190),f=r(c);t["default"]=u["default"].createClass({displayName:"switch",getDefaultProps:function(){return{prefixCls:"ant-switch",size:"default"}},render:function(){var e,t=this.props,n=t.prefixCls,r=t.size,i=t.className,s=(0,f["default"])((e={},a(e,i,!!i),a(e,n+"-"+r,!0),e));return u["default"].createElement(l["default"],o({className:s},this.props))}}),e.exports=t["default"]},811:function(e,t,n){"use strict";e.exports=n(812)},812:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){}var o=n(1),i=n(190),l=o.createClass({displayName:"Switch",propTypes:{className:o.PropTypes.string,prefixCls:o.PropTypes.string,disabled:o.PropTypes.bool,style:o.PropTypes.object,checkedChildren:o.PropTypes.any,unCheckedChildren:o.PropTypes.any,onChange:o.PropTypes.func},getDefaultProps:function(){return{prefixCls:"rc-switch",style:{},checkedChildren:null,unCheckedChildren:null,className:"",defaultChecked:!1,onChange:a}},getInitialState:function(){var e=this.props,t=!1;return t="checked"in e?!!e.checked:!!e.defaultChecked,{checked:t}},componentWillReceiveProps:function(e){"checked"in e&&this.setState({checked:!!e.checked})},toggle:function(){var e=!this.state.checked;"checked"in this.props||this.setState({checked:e}),this.props.onChange(e)},render:function(){var e,t=this.props,n=t.className,l=t.prefixCls,s=t.disabled,u=t.style,c=t.checkedChildren,f=t.unCheckedChildren,p=this.state.checked,d=i((e={},r(e,n,!!n),r(e,l,!0),r(e,l+"-checked",p),r(e,l+"-disabled",s),e));return o.createElement("span",{className:d,onClick:s?a:this.toggle,style:u},o.createElement("span",{className:l+"-inner"},p?c:f))}});e.exports=l},813:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(691),s=r(l),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(154),f=n(1),p=(n(153),function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={showModal:!1,loading:!1,callback:null},i=n,o(r,i)}return i(t,e),u(t,[{key:"open",value:function(e){this.setState({showModal:!0,callback:e})}},{key:"close",value:function(){this.setState({showModal:!1})}},{key:"updateLayers",value:function(){this.setState({showModal:!1})}},{key:"handleEdit",value:function(e){var t=this.props.map.refs.map,n=e.feature;t.selectedFeatures.clear(),t.selectedFeatures.push(n),this.close()}},{key:"renderContourInfo",value:function(){var e=this;if(console.log(this.props.contours),null!=this.props.contours){var t=this.props.contours.map(function(t,n){return f.createElement("tr",{key:n},f.createElement("td",null,t.value," m"),f.createElement("td",null,1==t.type?"闭合":"开放"),f.createElement("td",null,f.createElement("a",{href:"javascript:(0)",onClick:e.handleEdit.bind(e,t),style:{color:"#2db7f5",fontSize:12}},"编辑")))});return t}}},{key:"render",value:function(){return f.createElement(s["default"],{title:"等高线信息",visible:this.state.showModal,onCancel:this.close.bind(this),width:800},f.createElement("div",{className:"modal-body",style:{maxHeight:360}},f.createElement(c.Table,null,f.createElement("thead",null,f.createElement("tr",null,f.createElement("th",null,"高程值"),f.createElement("th",null,"类型"),f.createElement("th",null,"操作"))),f.createElement("tbody",null,this.renderContourInfo()))))}}]),t}(f.Component));t["default"]=p},814:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(691),s=r(l),u=n(815),c=r(u),f=n(737),p=r(f),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=n(154),y=n(1),v=(n(153),function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={showModal:!1,loading:!1,callback:null,selected:null},i=n,o(r,i)}return i(t,e),h(t,[{key:"open",value:function(e){this.setState({showModal:!0,callback:e})}},{key:"close",value:function(){this.setState({showModal:!1})}},{key:"ok",value:function(){return null==this.state.selected?void p["default"].info("还没有选择任何图层!",3):(this.setState({showModal:!1}),void(null!=this.state.callback&&this.state.callback(this.state.selected)))}},{key:"handleSelect",value:function(e){console.log(e),this.setState({selected:e})}},{key:"renderLayerList",value:function(){var e=this;if(null!=this.props.layers){var t=function(){var t=[];return e.props.layers.forEach(function(n,r,a){var o=!1;n==e.state.selected&&(o=!0),t.push(y.createElement("tr",{key:r},y.createElement("td",null," ",y.createElement(c["default"],{checked:o,onClick:e.handleSelect.bind(e,n),readOnly:!0})),y.createElement("td",null,r),y.createElement("td",null,n.get("name")||"Undefined"),y.createElement("td",null,"否")))}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":d(t)))return t.v}}},{key:"render",value:function(){return y.createElement(s["default"],{title:"选择需要开始编辑的图层",width:680,visible:this.state.showModal,onCancel:this.close.bind(this),onOk:this.ok.bind(this)},y.createElement(m.Table,null,y.createElement("thead",null,y.createElement("tr",null,y.createElement("th",null,"选择"),y.createElement("th",null,"编号"),y.createElement("th",null,"图层名"),y.createElement("th",null,"锁定"))),y.createElement("tbody",null,this.renderLayerList())))}}]),t}(y.Component));t["default"]=v},815:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(816),o=r(a),i=n(821),l=r(i),s=n(822),u=r(s);o["default"].Button=u["default"],o["default"].Group=l["default"],t["default"]=o["default"],e.exports=t["default"]},816:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(817),i=r(o),l=n(1),s=r(l),u=s["default"].createClass({displayName:"AntRadio",getDefaultProps:function(){return{prefixCls:"ant-radio"}},render:function(){var e=this.props.className;return e&&(e+=this.props.checked?" "+e+"-checked":""),this.props.disabled&&(e+=" "+this.props.className+"-disabled"),s["default"].createElement("label",{className:e},s["default"].createElement(i["default"],a({},this.props,{children:null})),this.props.children)}});t["default"]=u,e.exports=t["default"]},817:function(e,t,n){"use strict";e.exports=n(818)},818:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(1),o=n(819),i=a.createClass({displayName:"Radio",getDefaultProps:function(){return{prefixCls:"rc-radio",type:"radio"}},render:function(){return a.createElement(o,r({},this.props,{ref:"checkbox"}))}});e.exports=i},819:function(e,t,n){"use strict";e.exports=n(820)},820:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;l=u=s=void 0,r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0}},c=n(1),f=r(c),p=n(190),d=r(p),h=function(e){function t(e){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleChange=this.handleChange.bind(this);var n=!1;n="checked"in e?e.checked:e.defaultChecked,this.state={checked:n}}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){"checked"in e&&this.setState({checked:e.checked})}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,r=this.state.checked;return"boolean"==typeof r&&(r=r?1:0),f["default"].createElement("span",{className:(0,d["default"])((e={},a(e,t.className,!!t.className),a(e,n,1),a(e,n+"-checked",r),a(e,n+"-checked-"+r,!!r),a(e,n+"-disabled",t.disabled),e)),style:t.style},f["default"].createElement("span",{className:n+"-inner"}),f["default"].createElement("input",l({},t,{defaultChecked:!!t.defaultChecked,className:n+"-input",checked:!!r,onChange:this.handleChange})))}},{key:"handleChange",value:function(e){var t=e.target.checked;"checked"in this.props||this.setState({checked:t?1:0}),this.props.onChange(e,this.state.checked)}}]),t}(f["default"].Component);t["default"]=h,h.propTypes={prefixCls:f["default"].PropTypes.string,style:f["default"].PropTypes.object,type:f["default"].PropTypes.string,className:f["default"].PropTypes.string,defaultChecked:f["default"].PropTypes.oneOfType([f["default"].PropTypes.number,f["default"].PropTypes.bool]),checked:f["default"].PropTypes.oneOfType([f["default"].PropTypes.number,f["default"].PropTypes.bool]),onChange:f["default"].PropTypes.func},h.defaultProps={prefixCls:"rc-checkbox",style:{},type:"checkbox",className:"",defaultChecked:0,onChange:function(){}},e.exports=t["default"]},821:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e){var t=null;return l["default"].Children.forEach(e,function(e){e.props&&e.props.checked&&(t=e.props.value)}),t}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),l=r(i),s=n(816),u=r(s);t["default"]=l["default"].createClass({displayName:"group",getDefaultProps:function(){return{prefixCls:"ant-radio-group",disabled:!1,onChange:function(){}}},getInitialState:function(){var e=this.props;return{value:e.value||e.defaultValue||a(e.children)}},componentWillReceiveProps:function(e){("value"in e||a(e.children))&&this.setState({value:e.value||a(e.children)})},render:function(){var e=this,t=this.props,n=l["default"].Children.map(t.children,function(t){return t.props?l["default"].createElement(u["default"],o({key:t.props.value},t.props,{onChange:e.onRadioChange,checked:e.state.value===t.props.value,disabled:t.props.disabled||e.props.disabled})):t});return l["default"].createElement("div",{className:t.prefixCls},n)},onRadioChange:function(e){this.setState({value:e.target.value}),this.props.onChange(e)}}),e.exports=t["default"]},822:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),i=n(816),l=r(i),s=o["default"].createClass({displayName:"RadioButton",getDefaultProps:function(){return{className:"ant-radio-button"}},render:function(){return o["default"].createElement(l["default"],this.props)}});t["default"]=s,e.exports=t["default"]},823:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){n(this,e)}return r(e,null,[{key:"read",value:function(e){var t=new ol.Collection;if(e.length<=0)return t;for(var n=0;n<e.length;n++)if(!(e[n].length<4)){var r=new ol.Feature({geometry:new ol.geom.Point([parseFloat(e[n][2]),parseFloat(e[n][3]),parseFloat(e[n][4])],"XYZ"),name:e[n][0]});r.getGeometry().set("z",parseFloat(e[n][4])),t.push(r)}return console.info(t),t}},{key:"readRaw",value:function(e){var t=new Array;if(e.length<=0)return t;for(var n=0;n<e.length;n++)if(!(e[n].length<4)){var r=parseFloat(e[n][2]),a=parseFloat(e[n][3]),o=parseFloat(e[n][4]);t.push([r,a,o])}return console.info(t),t}},{key:"readFeatures",value:function(e){var t=new Array;return e.length<=0?t:(e.forEach(function(e){var n=e.getGeometry(),r=n.getCoordinates(),a=parseFloat(r[0]),o=parseFloat(r[1]),i=parseFloat(n.get("z")||0);3==r.length&&(i=parseFloat(r[2])),t.push([a,o,i])}),console.info(t),t)}}]),e}();t["default"]=a},824:function(e,t,n){"use strict";var r;!function(){function t(e){var t,n,r,a,o,i,l=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(t=e.length;t--;)e[t][0]<l&&(l=e[t][0]),e[t][0]>u&&(u=e[t][0]),e[t][1]<s&&(s=e[t][1]),e[t][1]>c&&(c=e[t][1]);return n=u-l,r=c-s,a=Math.max(n,r),o=l+.5*n,i=s+.5*r,[[o-20*a,i-a],[o,i+20*a],[o+20*a,i-a]]}function n(e,t,n,r){var a,i,l,s,u,c,f,p,d,h,m=e[t][0],y=e[t][1],v=e[n][0],b=e[n][1],g=e[r][0],E=e[r][1],w=Math.abs(y-b),k=Math.abs(b-E);if(o>w&&o>k)throw new Error("Eek! Coincident points!");return o>w?(s=-((g-v)/(E-b)),c=(v+g)/2,p=(b+E)/2,a=(v+m)/2,i=s*(a-c)+p):o>k?(l=-((v-m)/(b-y)),u=(m+v)/2,f=(y+b)/2,a=(g+v)/2,i=l*(a-u)+f):(l=-((v-m)/(b-y)),s=-((g-v)/(E-b)),u=(m+v)/2,c=(v+g)/2,f=(y+b)/2,p=(b+E)/2,a=(l*u-s*c+p-f)/(l-s),i=w>k?l*(a-u)+f:s*(a-c)+p),d=v-a,h=b-i,{i:t,j:n,k:r,x:a,y:i,r:d*d+h*h}}function a(e){var t,n,r,a,o,i;for(n=e.length;n;)for(a=e[--n],r=e[--n],t=n;t;)if(i=e[--t],o=e[--t],r===o&&a===i||r===i&&a===o){e.splice(n,2),e.splice(t,2);break}}var o=1/1048576;r={triangulate:function(e,r){var i,l,s,u,c,f,p,d,h,m,y,v,b=e.length;if(3>b)return[];if(e=e.slice(0),r)for(i=b;i--;)e[i]=e[i][r];for(s=new Array(b),i=b;i--;)s[i]=i;for(s.sort(function(t,n){return e[n][0]-e[t][0]}),u=t(e),e.push(u[0],u[1],u[2]),c=[n(e,b+0,b+1,b+2)],f=[],p=[],i=s.length;i--;p.length=0){for(v=s[i],l=c.length;l--;)d=e[v][0]-c[l].x,d>0&&d*d>c[l].r?(f.push(c[l]),c.splice(l,1)):(h=e[v][1]-c[l].y,d*d+h*h-c[l].r>o||(p.push(c[l].i,c[l].j,c[l].j,c[l].k,c[l].k,c[l].i),c.splice(l,1)));for(a(p),l=p.length;l;)y=p[--l],m=p[--l],c.push(n(e,m,y,v))}for(i=c.length;i--;)f.push(c[i]);for(c.length=0,i=f.length;i--;)f[i].i<b&&f[i].j<b&&f[i].k<b&&c.push(f[i].i,f[i].j,f[i].k);return c},contains:function(e,t){if(t[0]<e[0][0]&&t[0]<e[1][0]&&t[0]<e[2][0]||t[0]>e[0][0]&&t[0]>e[1][0]&&t[0]>e[2][0]||t[1]<e[0][1]&&t[1]<e[1][1]&&t[1]<e[2][1]||t[1]>e[0][1]&&t[1]>e[1][1]&&t[1]>e[2][1])return null;var n=e[1][0]-e[0][0],r=e[2][0]-e[0][0],a=e[1][1]-e[0][1],o=e[2][1]-e[0][1],i=n*o-r*a;if(0===i)return null;var l=(o*(t[0]-e[0][0])-r*(t[1]-e[0][1]))/i,s=(n*(t[1]-e[0][1])-a*(t[0]-e[0][0]))/i;return 0>l||0>s||l+s>1?null:[l,s]}},e.exports=r}()},825:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(826),l=r(i),s=n(827),u=r(s),c=(n(828),n(829)),f=n(830),p=function(){function e(){a(this,e)}return o(e,null,[{key:"b_spline",value:function(e){var t=[];return e.forEach(function(e){var n=e.listPoint;if(n.length<=2)return void t.push(e);var r=e.value,a=[],o=new l["default"](r);o.type=e.type;for(var i=0;i<n.length;i++)a.push([n[i].x,n[i].y]);for(var s=0;1>s;s+=.01){var c=f(s,3,a),p=new u["default"](c[0],c[1],r);o.listPoint.push(p)}t.push(o)}),t}},{key:"cardinal_spline",value:function(e){var t=[];return e.forEach(function(e){var n=e.listPoint;if(n.length<=2)return void t.push(e);var r=e.value,a=[],o=new l["default"](r);o.type=e.type;for(var i=0;i<n.length;i++)a.push(n[i].x),a.push(n[i].y);for(var s=c.getCurvePoints(a,.05,20),f=0;f<s.length;f+=2){var p=new u["default"](s[f],s[f+1],r);o.listPoint.push(p)}t.push(o)}),t}}]),e}();t["default"]=p},826:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function a(e){n(this,a),this.value=e,this.listPoint=[],this.type=1};t["default"]=r},827:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function a(e,t,r){n(this,a),this.x=e,this.y=t,this.z=r,this.id=-1,this.listIdEdge=[],this.listIdLine=[],this.listIdTri=[]};t["default"]=r},828:function(e,t){function n(e,t){return r(e.length)(e,t)}function r(e){if(e=0|+e,!e)throw new Error("Cannot create a interpolator with no elements");if(s[e])return s[e];for(var t=["var ut = 1 - t",""],n=e;n--;){for(var r=0;n>r;r+=1)n+1===e?t.push("var p"+r+" = arr["+r+"] * ut + arr["+(r+1)+"] * t"):n>1?t.push("p"+r+" = p"+r+" * ut + p"+(r+1)+" * t"):t.push("return p"+r+" * ut + p"+(r+1)+" * t");n>1&&t.push("")}return t=["return function bezier"+e+"(arr, t) {",t.map(function(e){return"  "+e}).join("\n"),"}"].join("\n"),Function(t)()}function a(e){return e[0]}function o(e,t){return e[0]+(e[1]-e[0])*t}function i(e,t){var n=1-t;return(e[0]*n+e[1]*t)*n+(e[1]*n+e[2]*t)*t}function l(e,t){var n=1-t,r=e[1]*n+e[2]*t;return((e[0]*n+e[1]*t)*n+r*t)*n+(r*n+(e[2]*n+e[3]*t)*t)*t}var s={1:a,2:o,3:i,4:l};e.exports=n,e.exports.prepare=r},829:function(e,t,n){/*!	Curve calc function for canvas 2.3.4
	 *	(c) Epistemex 2013-2016
	 *	www.epistemex.com
	 *	License: MIT
	 */
function r(e,t,n,r){"use strict";function a(e,t,r,a){for(var o,i=2;r>i;i+=2){var l,u,f,p,d=e[i],h=e[i+1],m=e[i+2],y=e[i+3],v=(m-e[i-2])*a,b=(y-e[i-1])*a,g=(e[i+4]-d)*a,E=(e[i+5]-h)*a,w=0;for(o=0;n>o;o++)l=t[w++],u=t[w++],f=t[w++],p=t[w++],c[s++]=l*d+u*m+f*v+p*g,c[s++]=l*h+u*y+f*b+p*E}}t="number"==typeof t?t:.5,n="number"==typeof n?n:25;var o,i=1,l=e.length,s=0,u=(l-2)*n+2+(r?2*n:0),c=new Float32Array(u),f=new Float32Array(4*(n+2)),p=4;for(o=e.slice(0),r?(o.unshift(e[l-1]),o.unshift(e[l-2]),o.push(e[0],e[1])):(o.unshift(e[1]),o.unshift(e[0]),o.push(e[l-2],e[l-1])),f[0]=1;n>i;i++){var d=i/n,h=d*d,m=h*d,y=2*m,v=3*h;f[p++]=y-v+1,f[p++]=v-y,f[p++]=m-2*h+d,f[p++]=m-h}return f[++p]=1,a(o,f,l,t),r&&(o=[],o.push(e[l-4],e[l-3],e[l-2],e[l-1],e[0],e[1],e[2],e[3]),a(o,f,4,t)),l=r?0:e.length-2,c[s++]=e[l++],c[s]=e[l],c}t.getCurvePoints=r},830:function(e,t){function n(e,t,n,r,a,o){var i=n.length,l=n[0].length;if(2>t)throw new Error("order must be at least 2 (linear)");if(t>i)throw new Error("order must be less than point count");if(!a){a=new Array(i);for(var s=0;i>s;s++)a[s]=1}if(r){if(r.length!==i+t)throw new Error("bad knot vector length")}else for(var r=new Array(i+t),s=0;i+t>s;s++)r[s]=s;var u=[t-1,r.length-1-(t-1)],c=r[u[0]],f=r[u[1]];if(e=e*(f-c)+c,c>e||e>f)throw new Error("out of bounds");for(var p=u[0];p<u[1]&&!(e>=r[p]&&e<=r[p+1]);p++);for(var d=new Array(i),s=0;i>s;s++){d[s]=new Array(l+1);for(var h=0;l>h;h++)d[s][h]=n[s][h]*a[s];d[s][l]=a[s]}for(var m=1;t>=m;m++)for(var s=p;s>p-t+m;s--)for(var y=(e-r[s])/(r[s+t-m]-r[s]),h=0;l+1>h;h++)d[s][h]=(1-y)*d[s-1][h]+y*d[s][h];for(var o=o||new Array(l),s=0;l>s;s++)o[s]=d[p][s]/d[p][l];return o}e.exports=n},831:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(827),l=r(i),s=n(832),u=r(s),c=n(833),f=(r(c),n(834)),p=r(f),d=n(826),h=r(d),m=function(){function e(t,n,r,o){a(this,e),this.dMax=Number.POSITIVE_INFINITY,this.dMin=Number.NEGATIVE_INFINITY,this.lineValue=[],this.lineNum=10,this.pointList=[],this.edgeList=[],this.triCheckIndex=new Set,this.triTotal=[],this.edgeBandIndex=[],this.contourLine=[],this.triangleNetWork=t,this.dMin=n,this.dMax=r,this.step=o,this.initial()}return o(e,[{key:"initial",value:function(){var e=this.triangleNetWork.length;if(!(2>e)){for(var t=0;e>t;t++){var n=this.triangleNetWork[t],r=this.assetPoint(new l["default"](n[0].x,n[0].y,n[0].z)),a=this.assetPoint(new l["default"](n[1].x,n[1].y,n[1].z)),o=this.assetPoint(new l["default"](n[2].x,n[2].y,n[2].z));-1==r.id&&(r.id=this.pointList.length,this.pointList.push(r)),-1==a.id&&(a.id=this.pointList.length,this.pointList.push(a)),-1==o.id&&(o.id=this.pointList.length,this.pointList.push(o));var i=this.assetEdge(new p["default"](r.id,a.id)),s=this.assetEdge(new p["default"](a.id,o.id)),c=this.assetEdge(new p["default"](o.id,r.id));-1==i.id&&(i.id=this.edgeList.length,this.edgeList.push(i)),r.listIdEdge.push(i.id),a.listIdEdge.push(i.id),-1==s.id&&(s.id=this.edgeList.length,this.edgeList.push(s)),a.listIdEdge.push(s.id),o.listIdEdge.push(s.id),-1==c.id&&(c.id=this.edgeList.length,this.edgeList.push(c)),o.listIdEdge.push(c.id),r.listIdEdge.push(c.id);var f=new u["default"];f.id=this.triTotal.length,f.edgeIndex.push(i.id),f.edgeIndex.push(s.id),f.edgeIndex.push(c.id),f.pointIndex.push(r.id),f.pointIndex.push(a.id),f.pointIndex.push(o.id),this.triTotal.push(f),r.listIdTri.push(f.id),a.listIdTri.push(f.id),o.listIdTri.push(f.id),i.listTri.push(f.id),s.listTri.push(f.id),c.listTri.push(f.id),i.numRef++,s.numRef++,c.numRef++}for(var d=0;d<this.edgeList.length;d++)this.edgeList[d].numRef<2&&this.edgeBandIndex.push(this.edgeList[d].id)}}},{key:"assetPoint",value:function(e){for(var t=0;t<this.pointList.length;t++){var n=this.pointList[t];if(e.x==n.x&&e.y==n.y){e=this.pointList[t];break}}return e}},{key:"assetEdge",value:function(e){for(var t=!0,n=0;n<this.edgeList.length;n++){var r=this.edgeList[n];(e.endId==r.endId&&e.startId==r.startId||e.endId==r.startId&&e.startId==r.endId)&&(e=this.edgeList[n],t=!1)}return e}},{key:"assetValue",value:function(e){}},{key:"contourPointCalc",value:function(e,t,n){var r=new l["default"](0,0,e),a=this.pointList[t].z,o=this.pointList[n].z,i=(e-a)/(o-a);return r.x=this.pointList[t].x+i*(this.pointList[n].x-this.pointList[t].x),r.y=this.pointList[t].y+i*(this.pointList[n].y-this.pointList[t].y),r}},{key:"contourLineCalc",value:function(){for(var e=this.dMin+1|0;e<(0|this.dMax);e++)e%this.step==0&&this.lineValue.push(e)}},{key:"contourLineTrace",value:function(){this.contourLineCalc();for(var e=0;e<this.lineValue.length;e++){var t=this.lineValue[e];this.triCheckIndex.clear();for(var n=0;n<this.triTotal.length;n++){var r=this.pointList[this.triTotal[n].pointIndex[0]].z,a=this.pointList[this.triTotal[n].pointIndex[1]].z,o=this.pointList[this.triTotal[n].pointIndex[2]].z;0>=(r-t)*(a-t)?this.triCheckIndex.add(this.triTotal[n].id):0>=(a-t)*(o-t)?this.triCheckIndex.add(this.triTotal[n].id):0>=(o-t)*(r-t)&&this.triCheckIndex.add(this.triTotal[n].id)}if(!(this.triCheckIndex.size<2)){for(var i=0;i<this.edgeBandIndex.length;i++){var l=this.edgeBandIndex[i],s=new h["default"];if(this.isContourOnEdge(t,l)){var u=this.contourPointCalc(t,this.edgeList[l].startId,this.edgeList[l].endId);for(u.listIdEdge.push(l),s.listPoint.push(u);this.triCheckIndex.size>0;){var c=this.searchTriangle(l);if(-1==c)break;var f=this.traceTriangle(t,c,l);if(-1!=f){if(l=f,this.isContourOnEdge(t,f)){var p=this.contourPointCalc(t,this.edgeList[f].startId,this.edgeList[f].endId);p.listIdEdge.push(f),s.listPoint.push(p)}if(this.edgeList[f].numRef<2){s.type=0,s.value=t,console.log(s),this.contourLine.push(s),s=new h["default"];break}}}if(this.triCheckIndex.size<1)break}}if(this.triCheckIndex.size>2)for(var d=-1;this.triCheckIndex.size>0;){var m=null,y=!0,v=!1,b=void 0;try{for(var g,E=this.triCheckIndex.values()[Symbol.iterator]();!(y=(g=E.next()).done);y=!0){var w=g.value;m=w;break}}catch(k){v=!0,b=k}finally{try{!y&&E["return"]&&E["return"]()}finally{if(v)throw b}}this.triCheckIndex["delete"](m);for(var P=new h["default"],C=this.triTotal[m],O=0;O<C.edgeIndex.length;O++)if(this.isContourOnEdge(t,C.edgeIndex[O])){d=C.edgeIndex[O];var N=this.contourPointCalc(t,this.edgeList[d].startId,this.edgeList[d].endId);N.listIdEdge.push(d),P.listPoint.push(N);break}for(;this.triCheckIndex.size>0;){var x=this.searchTriangle(d);if(-1==x){var T=P.listPoint.slice(-1)[0];P.type=1,T&&this.isEdgeTriangleOnBand(T.listIdEdge[0])&&(P.type=0),P.value=t,this.contourLine.push(P),P=new h["default"];break}var _=this.traceTriangle(t,x,d);if(-1!=_&&(d=_,this.isContourOnEdge(t,_))){var j=this.contourPointCalc(t,this.edgeList[d].startId,this.edgeList[d].endId);j.listIdEdge.push(d),P.listPoint.push(j)}if(0==this.triCheckIndex.size){var S=P.listPoint.slice(-1)[0];console.log(S),P.type=1,S&&this.isEdgeTriangleOnBand(S.listIdEdge[0])&&(P.type=0),P.value=t,this.contourLine.push(P),P=new h["default"];break}}}}}return this.contourLine}},{key:"isEdgeTriangleOnBand",value:function(e){console.log("checking");for(var t=this.edgeList[e],n=0;n<t.listTri.length;n++)for(var r=this.triTotal[t.listTri[n]],a=0;a<r.edgeIndex.length;a++)if(this.edgeList[r.edgeIndex[a]].numRef<2)return!0;return!1}},{key:"isContourOnEdge",value:function(e,t){var n=this.edgeList[t],r=this.pointList[n.startId],a=this.pointList[n.endId],o=(r.z-e)*(a.z-e);if(0==o){for(var i=0;i<this.pointList.length;i++)Math.abs(this.pointList[i].z-e)<1e-8&&(this.pointList[i].z+=1e-4);return!0}return 0>o}},{key:"searchTriangle",value:function(e){for(var t=this.edgeList[e],n=0;n<t.listTri.length;n++)if(this.triCheckIndex.has(t.listTri[n]))return this.triCheckIndex["delete"](t.listTri[n]),t.listTri[n];return-1}},{key:"traceTriangle",value:function(e,t,n){var r=this.triTotal[t],a=[];a.push(this.edgeList[r.edgeIndex[0]]),a.push(this.edgeList[r.edgeIndex[1]]),a.push(this.edgeList[r.edgeIndex[2]]);for(var o=0;o<a.length;o++){var i=a[o];if(i.id!=n){var l=(this.pointList[i.startId].z-e)*(this.pointList[i.endId].z-e);if(0>=l)return i.id}}return-1}},{key:"traceFill",value:function(){}}]),e}();t["default"]=m},832:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function a(){n(this,a),this.id=-1,this.edgeIndex=[],this.pointIndex=[]};t["default"]=r},833:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){n(this,e),this.listPoints=[]}return r(e,[{key:"start",value:function(){return this.listPoints[0]}},{key:"end",value:function(){var e=this.listPoints.length;return this.listPoints[e-1]}},{key:"insertPoint",value:function(e){}}]),e}();t["default"]=a},834:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function a(e,t){n(this,a),this.id=-1,this.numRef=0,this.listTri=[],this.startId=e,this.endId=t};t["default"]=r},835:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(691),s=r(l),u=n(732),c=r(u),f=n(737),p=r(f),d=n(815),h=r(d),m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=n(154),b=n(1),g=(n(153),h["default"].Button,h["default"].Group),E=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={showModal:!1,selected:null,type:"0",file:null,callback:null},i=n,o(r,i)}return i(t,e),y(t,[{key:"open",value:function(e){this.setState({showModal:!0,callback:e})}},{key:"close",value:function(){this.setState({showModal:!1})}},{key:"onChange",value:function(e){this.setState({type:e.target.value})}},{key:"handleSelect",value:function(e){this.setState({selected:e})}},{key:"handleOk",value:function(){var e=this;this.state.selected?!function(){e.close();var t=e.props.map.refs.map.select.getFeatures();if(t.clear(),"0"==e.state.type){var n=e.state.selected.getSource(),r=n.getFeatures();r.forEach(function(e){var n=e.getGeometry();n instanceof ol.geom.Point&&t.push(e)}),null!=e.state.callback&&e.state.callback(t)}else!function(){var n=p["default"].info("请选择地图上的高程点!",0),r=new Promise(function(n,r){var a=e.props.map.refs.map.dragBox;a.once("boxend",function(){var r=a.getGeometry().getExtent();e.state.selected.getSource().forEachFeatureIntersectingExtent(r,function(e){var n=e.getGeometry();n instanceof ol.geom.Point&&t.push(e)}),n(t)}),setTimeout(r,3e4)});r.then(function(t){n(),null!=e.state.callback&&e.state.callback(t)},function(){n(),p["default"].info("选择高程点超时!",2)})}()}():p["default"].info("还没有选择图层",2)}},{key:"renderLayerList",value:function(){var e=this;if(null!=this.props.layers){var t=function(){var t=[];return e.props.layers.forEach(function(n,r,a){var o=!1;n==e.state.selected&&(o=!0),t.push(b.createElement("tr",{key:r},b.createElement("td",null," ",b.createElement(h["default"],{type:"radio",checked:o,onClick:e.handleSelect.bind(e,n),readOnly:!0})),b.createElement("td",null,r),b.createElement("td",null,n.get("name")||"Undefined"),b.createElement("td",null,"否")))}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":m(t)))return t.v}}},{key:"render",value:function(){return b.createElement(s["default"],{title:"生成三角网",visible:this.state.showModal,onCancel:this.close.bind(this),footer:b.createElement(c["default"],{type:"primary",onClick:this.handleOk.bind(this)},"确定")},b.createElement("div",null,b.createElement("h5",null,"选择离散点图层"),b.createElement(v.Table,null,b.createElement("thead",null,b.createElement("tr",null,b.createElement("th",null,"选择"),b.createElement("th",null,"编号"),b.createElement("th",null,"图层名"),b.createElement("th",null,"锁定"))),b.createElement("tbody",null,this.renderLayerList())),b.createElement(g,{value:this.state.type,onChange:this.onChange.bind(this)},b.createElement(h["default"],{value:"0"},"使用图层全部点"),b.createElement(h["default"],{value:"1"},"框选部分数据"))))}}]),t}(b.Component);t["default"]=E},836:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(691),s=r(l),u=n(837),c=r(u),f=n(841),p=r(f),d=n(842),h=r(d),m=n(732),y=r(m),v=n(843),b=r(v),g=n(815),E=r(g),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),k=(n(154),n(1)),P=(n(153),E["default"].Button,E["default"].Group),C=b["default"].Item,O=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,s=Array(l),u=0;l>u;u++)s[u]=arguments[u];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={showModal:!1,selected:null,type:"0",file:null,step:1,callback:null},i=n,o(r,i)}return i(t,e),w(t,[{key:"open",value:function(e){this.setState({showModal:!0,callback:e})}},{key:"close",value:function(){this.setState({showModal:!1})}},{key:"onChange",value:function(e){console.log("radio checked:"+e.target.value),this.setState({type:e.target.value})}},{key:"handleSelect",value:function(e){console.log(e),this.setState({selected:e})}},{key:"handleOk",value:function(){null!=this.state.callback&&this.state.callback(this.state.step,this.state.type),this.close()}},{key:"handleChange",value:function(e){this.setState({step:e.target.value})}},{key:"render",value:function(){return k.createElement(s["default"],{title:"生成等高线",visible:this.state.showModal,onCancel:this.close.bind(this),footer:k.createElement(y["default"],{type:"primary",onClick:this.handleOk.bind(this)},"确定")},k.createElement(c["default"],null,k.createElement(p["default"],{span:"8"},k.createElement(C,{label:"最小高程：",labelCol:{span:10},wrapperCol:{span:14}},k.createElement(h["default"],{disabled:!0,value:this.props.zMin||0}))),k.createElement(p["default"],{span:"8"},k.createElement(C,{label:"最大高程：",labelCol:{span:10},wrapperCol:{span:14}},k.createElement(h["default"],{disabled:!0,value:this.props.zMax||0}))),k.createElement(p["default"],{span:"8"},k.createElement(C,{label:"等高距：",labelCol:{span:10},wrapperCol:{span:14}},k.createElement(h["default"],{value:this.state.step,onChange:this.handleChange.bind(this)}))),k.createElement(p["default"],{span:"24"},k.createElement("p",{style:{marginTop:10}},"等高线光滑参数设置"),k.createElement(P,{value:this.state.type,onChange:this.onChange.bind(this)},k.createElement(E["default"],{value:"0"},"不平滑"),k.createElement(E["default"],{value:"1"},"三次B样条函数平滑"),k.createElement(E["default"],{value:"2"},"张力样条函数平滑")))))}}]),t}(k.Component);t["default"]=O},837:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(838);t["default"]=r.Row,e.exports=t["default"]},838:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Col=t.Row=void 0;var a=n(839),o=r(a),i=n(840),l=r(i);t.Row=o["default"],t.Col=l["default"]},839:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var l=n(1),s=r(l),u=n(190),c=r(u),f=s["default"].createClass({displayName:"Row",propTypes:{type:s["default"].PropTypes.string,align:s["default"].PropTypes.string,justify:s["default"].PropTypes.string,className:s["default"].PropTypes.string,children:s["default"].PropTypes.node},render:function(){var e,t=this.props,n=t.type,r=t.justify,l=t.align,u=t.className,f=o(t,["type","justify","align","className"]),p=(0,c["default"])((e={row:!0},a(e,"row-"+n,n),a(e,"row-"+n+"-"+r,r),a(e,"row-"+n+"-"+l,l),a(e,u,u),e));return s["default"].createElement("div",i({},f,{className:p}),this.props.children)}});t["default"]=f,e.exports=t["default"]},840:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var l=n(1),s=r(l),u=n(190),c=r(u),f=s["default"].createClass({displayName:"Col",propTypes:{span:s["default"].PropTypes.string,order:s["default"].PropTypes.string,offset:s["default"].PropTypes.string,push:s["default"].PropTypes.string,pull:s["default"].PropTypes.string,className:s["default"].PropTypes.string,children:s["default"].PropTypes.node},render:function(){var e,t=this.props,n=t.span,r=t.order,l=t.offset,u=t.push,f=t.pull,p=t.className,d=o(t,["span","order","offset","push","pull","className"]),h=(0,c["default"])((e={},a(e,"col-"+n,n),a(e,"col-order-"+r,r),a(e,"col-offset-"+l,l),a(e,"col-push-"+u,u),a(e,"col-pull-"+f,f),a(e,p,p),e));return s["default"].createElement("div",i({},d,{className:h}),this.props.children)}});t["default"]=f,e.exports=t["default"]},841:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(838);t["default"]=r.Col,e.exports=t["default"]},842:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return n.map(function(t){return e+"-"+t}).join(" ")}function s(){if(void 0===("undefined"==typeof document?"undefined":p(document)))return!1;var e=document.documentMode||0;return e>9}function u(e){return"undefined"==typeof e||null===e?"":e}var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},d=n(1),h=r(d),m=n(718),y=r(m),v=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),f(t,[{key:"render",value:function(){var e="ant-input-group "+(this.props.className||"");return h["default"].createElement("span",{className:e,style:this.props.style},this.props.children)}}]),t}(h["default"].Component);v.propTypes={children:h["default"].PropTypes.any};var b=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),f(t,[{key:"renderLabledInput",value:function(e){var t=this.props,n=l(t.prefixCls,"input-group"),r=l(n,"addon"),a=t.addonBefore?h["default"].createElement("span",{className:r},t.addonBefore):null,o=t.addonAfter?h["default"].createElement("span",{className:r},t.addonAfter):null;return h["default"].createElement("span",{className:a||o?n:""},a,e,o)}},{key:"renderInput",value:function(){var e=(0,y["default"])({},this.props),t=e.prefixCls,n=l(t,"input");if(!e.type)return e.children;switch(e.size){case"small":n=l(t,"input","input-sm");break;case"large":n=l(t,"input","input-lg")}var r=e.placeholder;switch(r&&s()&&(r=null),"value"in e&&(e.value=u(e.value)),e.type){case"textarea":return h["default"].createElement("textarea",c({},e,{placeholder:r,className:n,ref:"input"}));default:return n=e.className?e.className:n,h["default"].createElement("input",c({},e,{placeholder:r,className:n,ref:"input"}))}}},{key:"render",value:function(){return this.renderLabledInput(this.renderInput())}}]),t}(h["default"].Component);b.propTypes={type:h["default"].PropTypes.string,id:h["default"].PropTypes.oneOfType([h["default"].PropTypes.string,h["default"].PropTypes.number]),size:h["default"].PropTypes.oneOf(["small","default","large"]),disabled:h["default"].PropTypes.bool,value:h["default"].PropTypes.any,defaultValue:h["default"].PropTypes.any,className:h["default"].PropTypes.string,addonBefore:h["default"].PropTypes.node,addonAfter:h["default"].PropTypes.node,prefixCls:h["default"].PropTypes.string},b.defaultProps={defaultValue:"",disabled:!1,prefixCls:"ant",type:"text"},e.exports=b,e.exports.Group=v},843:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(844),o=r(a),i=n(845),l=r(i),s=n(846),u=r(s),c=n(842),f=r(c);o["default"].Item=l["default"],o["default"].ValueMixin=u["default"],o["default"].Form=o["default"],o["default"].Input=f["default"],t["default"]=o["default"],e.exports=t["default"]},844:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(1),f=r(c),p=n(190),d=r(p),h=function(e){function t(){return o(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return l(t,e),u(t,[{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,r=t.className,o=(0,d["default"])((e={},a(e,r,!!r),a(e,n+"-horizontal",this.props.horizontal),a(e,n+"-inline",this.props.inline),e));return f["default"].createElement("form",s({},this.props,{className:o}),this.props.children)}}]),t}(f["default"].Component);h.propTypes={prefixCls:f["default"].PropTypes.string,horizontal:f["default"].PropTypes.bool,inline:f["default"].PropTypes.bool,children:f["default"].PropTypes.any,onSubmit:f["default"].PropTypes.func},h.defaultProps={prefixCls:"ant-form"},e.exports=h},845:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return n.map(function(t){return e+"-"+t}).join(" ")}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(1),p=r(f),d=n(190),h=r(d),m=function(e){function t(){return o(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return l(t,e),c(t,[{key:"_getLayoutClass",value:function(e){if(!e)return"";var t=e.span,n=e.offset,r=t?"col-"+t:"",a=n?" col-offset-"+n:"";return r+a}},{key:"renderHelp",value:function(){var e=this.props.prefixCls;return p["default"].createElement("div",{className:this.props.help?s(e,"explain"):"",key:"help"},this.props.help)}},{key:"renderValidateWrapper",value:function(e,t){var n="";return this.props.validateStatus&&(n=(0,h["default"])({"has-feedback":this.props.hasFeedback,"has-success":"success"===this.props.validateStatus,"has-warning":"warning"===this.props.validateStatus,"has-error":"error"===this.props.validateStatus,"is-validating":"validating"===this.props.validateStatus})),p["default"].createElement("div",{className:n},e," ",t)}},{key:"renderWrapper",value:function(e){var t=this.props.wrapperCol;return p["default"].createElement("div",{className:this._getLayoutClass(t),key:"wrapper"},e)}},{key:"renderLabel",value:function(){var e=this.props.labelCol,t=this.props.required?"required":"";return this.props.label?p["default"].createElement("label",{htmlFor:this.props.id,className:this._getLayoutClass(e),required:t,key:"label"},this.props.label):null}},{key:"renderChildren",value:function(){return[this.renderLabel(),this.renderWrapper(this.renderValidateWrapper(this.props.children,this.renderHelp()))]}},{key:"_isCompact",value:function(e){var t=this,n=["checkbox","radio","radio-group","static","file"],r=!1;return Array.isArray(e)||(e=[e]),e.map(function(e){var a=e.props&&e.props.type,o=e.props&&e.props.prefixCls;o=o?o.substring(o.indexOf("-")+1):"",a&&n.indexOf(a)>-1||o&&n.indexOf(o)>-1?r=!0:e.props&&"object"===u(e.props.children)&&(r=t._isCompact(e.props.children))}),r}},{key:"renderFormItem",value:function(e){var t,n=this.props,r=n.prefixCls,o=(t={},a(t,r+"-item",!0),a(t,r+"-item-compact",this._isCompact(n.children)),a(t,r+"-item-with-help",!!n.help),t);return p["default"].createElement("div",{className:(0,h["default"])(o)},e)}},{key:"render",value:function(){var e=this.renderChildren();return this.renderFormItem(e)}}]),t}(p["default"].Component);m.propTypes={prefixCls:p["default"].PropTypes.string,label:p["default"].PropTypes.node,labelCol:p["default"].PropTypes.object,help:p["default"].PropTypes.node,validateStatus:p["default"].PropTypes.oneOf(["","success","warning","error","validating"]),hasFeedback:p["default"].PropTypes.bool,wrapperCol:p["default"].PropTypes.object,className:p["default"].PropTypes.string,children:p["default"].PropTypes.node},m.defaultProps={hasFeedback:!1,required:!1,prefixCls:"ant-form"},e.exports=m},846:function(e,t){"use strict";function n(){var e={},t=[].slice.call(arguments,0);return t.forEach(function(t){Object.keys(t).forEach(function(n){e[n]=t[n]})}),e}Object.defineProperty(t,"__esModule",{value:!0});var r={setValue:function(e,t){var r=t,a=t&&t.target;a&&(r="input"===(a.nodeName+"").toLowerCase()&&"checkbox"===a.type?a.checked:t.target.value);var o={};o[e]=r,this.setState({formData:n(this.state.formData,o)})}};t["default"]=r,e.exports=t["default"]},847:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a="undefined"!=typeof window.jQuery&&window.jQuery,o=function(){function e(){n(this,e)}return r(e,null,[{key:"getProps",value:function(e){var t=null;return t=a?a(e).attr("data-react-props"):document.querySelector(e).getAttribute("data-react-props"),null!=t&&(t=JSON.parse(t)),t}},{key:"mountComponents",value:function(e){}}]),e}();t["default"]=o}});